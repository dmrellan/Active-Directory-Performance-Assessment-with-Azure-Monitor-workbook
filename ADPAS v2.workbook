{
  "version": "Notebook/1.0",
  "items": [
    {
      "type": 1,
      "content": {
        "json": "## Active Directory Performance Assessment with Azure Monitor"
      },
      "name": "text - 0"
    },
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "crossComponentResources": [
          "{Workspace}"
        ],
        "parameters": [
          {
            "id": "54bedbbe-20b6-4f63-b683-bfb162cddcfb",
            "version": "KqlParameterItem/1.0",
            "name": "TimeRange",
            "type": 4,
            "isRequired": true,
            "typeSettings": {
              "selectableValues": [
                {
                  "durationMs": 3600000
                },
                {
                  "durationMs": 86400000
                },
                {
                  "durationMs": 604800000
                },
                {
                  "durationMs": 1209600000
                },
                {
                  "durationMs": 2592000000
                }
              ],
              "allowCustom": true
            },
            "timeContext": {
              "durationMs": 86400000
            },
            "value": {
              "durationMs": 604800000
            }
          },
          {
            "id": "bf579fe9-a7f4-4877-8452-1e66fdfb1531",
            "version": "KqlParameterItem/1.0",
            "name": "Subscriptions",
            "type": 6,
            "isRequired": true,
            "multiSelect": true,
            "quote": "'",
            "delimiter": ",",
            "isHiddenWhenLocked": true,
            "typeSettings": {
              "additionalResourceOptions": [
                "value::all"
              ],
              "includeAll": false,
              "showDefault": false
            },
            "timeContext": {
              "durationMs": 86400000
            },
            "defaultValue": "value::all"
          },
          {
            "id": "d5aa52a2-f394-4159-9d03-ad34ac899f60",
            "version": "KqlParameterItem/1.0",
            "name": "Workspace",
            "type": 5,
            "isRequired": true,
            "multiSelect": true,
            "quote": "'",
            "delimiter": ",",
            "query": "where type =~ 'microsoft.operationalinsights/workspaces'",
            "crossComponentResources": [
              "{Subscriptions}"
            ],
            "isHiddenWhenLocked": true,
            "typeSettings": {
              "additionalResourceOptions": [
                "value::1",
                "value::all"
              ],
              "showDefault": false
            },
            "defaultValue": "value::all",
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources",
            "value": [
              ""
            ]
          },
          {
            "id": "8972b1ba-7b79-4763-80b7-cd23ae781b04",
            "version": "KqlParameterItem/1.0",
            "name": "DomainName",
            "type": 2,
            "isRequired": true,
            "multiSelect": true,
            "quote": "'",
            "delimiter": ",",
            "query": "Heartbeat\r\n| project Computer\r\n| extend substring(Computer,indexof(Computer,\".\")+1,strlen(Computer)-indexof(Computer,\".\"))\r\n| distinct Column1",
            "crossComponentResources": [
              "{Workspace}"
            ],
            "isHiddenWhenLocked": true,
            "typeSettings": {
              "additionalResourceOptions": [
                "value::all"
              ],
              "showDefault": false
            },
            "queryType": 0,
            "resourceType": "microsoft.operationalinsights/workspaces",
            "value": [
              "value::all"
            ]
          }
        ],
        "style": "pills",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces"
      },
      "name": "parameters - 0"
    },
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "id": "f2be0efb-287e-4095-8fa3-cacc57a6b719",
            "version": "KqlParameterItem/1.0",
            "name": "Help",
            "label": "Show Help",
            "type": 10,
            "description": "Toggle the hidden Help/Guidance text boxes",
            "isRequired": true,
            "isHiddenWhenLocked": true,
            "typeSettings": {
              "additionalResourceOptions": [],
              "showDefault": false
            },
            "jsonData": "[\r\n    { \"value\": \"Yes\", \"label\": \"Yes\"},\r\n    { \"value\": \"No\", \"label\": \"No\", \"selected\": true}\r\n]",
            "timeContext": {
              "durationMs": 86400000
            }
          }
        ],
        "style": "pills",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces"
      },
      "name": "Help"
    },
    {
      "type": 11,
      "content": {
        "version": "LinkItem/1.0",
        "style": "tabs",
        "links": [
          {
            "id": "ea2d6fd9-e825-4c94-b12c-ebdc8b693252",
            "cellValue": "selectedTab",
            "linkTarget": "parameter",
            "linkLabel": "Availability",
            "subTarget": "Availability",
            "style": "link"
          },
          {
            "id": "0bc20b53-1d6f-46e5-8e2b-26c1ee57c19a",
            "cellValue": "selectedTab",
            "linkTarget": "parameter",
            "linkLabel": "Operating System",
            "subTarget": "OperatingSystem",
            "style": "link"
          },
          {
            "id": "fd2af2e3-135f-481a-9543-90ced5ad0637",
            "cellValue": "selectedTab",
            "linkTarget": "parameter",
            "linkLabel": "Active Directory",
            "subTarget": "ActiveDirectory",
            "style": "link"
          },
          {
            "id": "bd379256-cda5-4f15-b2ac-f12b1b4a94c2",
            "cellValue": "selectedTab",
            "linkTarget": "parameter",
            "linkLabel": "Detailed",
            "subTarget": "Detailed",
            "preText": "Authentications",
            "style": "primary"
          }
        ]
      },
      "name": "Navigation"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "AvailabilityGroup",
        "items": [
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "Heartbeat\r\n| where TimeGenerated > ago(60m)\r\n| where Computer in (MyDCs)\r\n| summarize count() by Computer, TimeGenerated, _ResourceId\r\n| make-series HourTrend = count() on TimeGenerated from ago(1h) to now() step 1m by Computer, _ResourceId\r\n| join kind=inner (\r\n    Heartbeat\r\n    | where TimeGenerated > ago(30d)\r\n    | where Computer in (MyDCs)\r\n    | summarize count() by Computer, TimeGenerated, _ResourceId\r\n    | make-series DailyTrend = count() on TimeGenerated from ago(30d) to now() step 1d by Computer, _ResourceId\r\n    )\r\n    on _ResourceId\r\n| join kind=inner (\r\n    Heartbeat \r\n    | where TimeGenerated > ago(30d)\r\n    | where Computer in (MyDCs)\r\n    | summarize heartbeatPerHour = count() by bin(TimeGenerated, 1h), Computer, _ResourceId\r\n    | extend availablePerHour = iff(heartbeatPerHour > 0, true, false)\r\n    | summarize totalAvailableHours = countif(availablePerHour == true) by Computer, _ResourceId\r\n    | extend availabilityRate = totalAvailableHours * 100.0 / (24*30)\r\n    )\r\n    on _ResourceId\r\n| sort by Computer asc\r\n| project-away _ResourceId, Computer1, _ResourceId1, Computer2, _ResourceId2\r\n",
              "size": 3,
              "showAnalytics": true,
              "title": "System Data Availability",
              "timeContextFromParameter": "TimeRange",
              "showRefreshButton": true,
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Computer",
                    "formatter": 0,
                    "formatOptions": {
                      "customColumnWidthSetting": "28ch"
                    }
                  },
                  {
                    "columnMatch": "HourTrend",
                    "formatter": 10,
                    "formatOptions": {
                      "min": 0,
                      "max": 1,
                      "palette": "redGreen"
                    }
                  },
                  {
                    "columnMatch": "TimeGenerated",
                    "formatter": 5
                  },
                  {
                    "columnMatch": "DailyTrend",
                    "formatter": 10,
                    "formatOptions": {
                      "palette": "redGreen"
                    }
                  },
                  {
                    "columnMatch": "TimeGenerated1",
                    "formatter": 5
                  },
                  {
                    "columnMatch": "totalAvailableHours",
                    "formatter": 8,
                    "formatOptions": {
                      "min": 0,
                      "max": 720,
                      "palette": "redGreen"
                    }
                  },
                  {
                    "columnMatch": "availabilityRate",
                    "formatter": 8,
                    "formatOptions": {
                      "min": 0,
                      "max": 100,
                      "palette": "redGreen"
                    },
                    "numberFormat": {
                      "unit": 1,
                      "options": {
                        "style": "decimal",
                        "maximumFractionDigits": 2
                      }
                    }
                  }
                ],
                "labelSettings": [
                  {
                    "columnId": "HourTrend",
                    "label": "Last hour (1m)",
                    "comment": "Each column represents 1 minute"
                  },
                  {
                    "columnId": "DailyTrend",
                    "label": "Last 30 days",
                    "comment": "Each column represents 1 day"
                  },
                  {
                    "columnId": "totalAvailableHours",
                    "label": "Available hours (30d)"
                  },
                  {
                    "columnId": "availabilityRate",
                    "label": "Availability"
                  }
                ]
              }
            },
            "name": "query - 0"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "selectedTab",
        "comparison": "isEqualTo",
        "value": "Availability"
      },
      "name": "AvailabilityGroup",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "OperatingSystemGroup",
        "items": [
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "parameters": [
                {
                  "id": "7fd398c9-6e13-4319-a8b8-3289dc423d9e",
                  "version": "KqlParameterItem/1.0",
                  "name": "Computer",
                  "type": 2,
                  "description": "Maximum number of selected computers: 10",
                  "isRequired": true,
                  "multiSelect": true,
                  "quote": "'",
                  "delimiter": ",",
                  "query": "Heartbeat\r\n| where Computer in (MyDCs)\r\n| distinct Computer\r\n| order by Computer asc",
                  "crossComponentResources": [
                    "{Workspace}"
                  ],
                  "typeSettings": {
                    "limitSelectTo": 10,
                    "additionalResourceOptions": [],
                    "showDefault": false
                  },
                  "timeContext": {
                    "durationMs": 0
                  },
                  "timeContextFromParameter": "TimeRange",
                  "queryType": 0,
                  "resourceType": "microsoft.operationalinsights/workspaces",
                  "value": [
                    "AST-Demo-DC02.contoso.com",
                    "VAST-Demo-DC01.contoso.com"
                  ]
                },
                {
                  "id": "4bf4bd96-531d-4d30-b1ba-1aef067fbc6e",
                  "version": "KqlParameterItem/1.0",
                  "name": "Granularity",
                  "type": 2,
                  "isRequired": true,
                  "isHiddenWhenLocked": true,
                  "typeSettings": {
                    "additionalResourceOptions": [],
                    "showDefault": false
                  },
                  "jsonData": "[\r\n    { \"value\":\"5m\", \"label\":\"5m\", \"selected\":false},\r\n    { \"value\":\"15m\", \"label\":\"15m\", \"selected\":true},\r\n    { \"value\":\"30m\", \"label\":\"30m\", \"selected\":false},\r\n    { \"value\":\"1h\", \"label\":\"1h\", \"selected\":false},\r\n    { \"value\":\"6h\", \"label\":\"6h\", \"selected\":false},\r\n    { \"value\":\"24h\", \"label\":\"24h\", \"selected\":false}  \r\n]"
                }
              ],
              "style": "pills",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "name": "ParametersOS"
          },
          {
            "type": 1,
            "content": {
              "json": "_To improve performance, granularity is calculated automatically to show always 100 points in these grapths. You can go to **Detailed** tab to analyze data deeply_"
            },
            "name": "text - 31"
          },
          {
            "type": 11,
            "content": {
              "version": "LinkItem/1.0",
              "style": "nav",
              "links": [
                {
                  "id": "d088f7f3-04b7-4dbd-8327-47dd1f645de9",
                  "cellValue": "TextProcessor",
                  "linkTarget": "step",
                  "linkLabel": "Processor",
                  "style": "primary"
                },
                {
                  "id": "3e19979a-74c4-446a-bdf4-9fb4aaf21d33",
                  "cellValue": "TextMemory",
                  "linkTarget": "step",
                  "linkLabel": "Memory",
                  "style": "primary"
                },
                {
                  "id": "c1914c85-8ae6-4a50-bbab-d888c01bea66",
                  "cellValue": "TextLogicalDisk",
                  "linkTarget": "step",
                  "linkLabel": "LogicalDisk",
                  "style": "primary"
                },
                {
                  "id": "bc80c6fb-cfb8-484a-b118-61fc9787c53e",
                  "cellValue": "TextNetwork",
                  "linkTarget": "step",
                  "linkLabel": "Network",
                  "style": "primary"
                }
              ]
            },
            "name": "links - 16"
          },
          {
            "type": 1,
            "content": {
              "json": "------"
            },
            "name": "text - 22"
          },
          {
            "type": 1,
            "content": {
              "json": "## Processor"
            },
            "customWidth": "10",
            "name": "TextProcessor"
          },
          {
            "type": 11,
            "content": {
              "version": "LinkItem/1.0",
              "style": "nav",
              "links": [
                {
                  "id": "3142de97-0271-4c36-9e7b-eb61a3f6eb79",
                  "cellValue": "ParametersOS",
                  "linkTarget": "step",
                  "linkLabel": "Go back",
                  "style": "secondary"
                }
              ]
            },
            "customWidth": "90",
            "name": "GoBackProcessor"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "//\\Processor(*)\\% Processor Time (_Total)\r\nPerf \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"Processor\" and CounterName == \"% Processor Time\" and InstanceName == \"_Total\" \r\n| summarize Used_CPU = round(avg(CounterValue),1) by Computer, bin(TimeGenerated, ({TimeRange:end} - {TimeRange:start})/100)\r\n| render timechart\r\n",
              "size": 0,
              "aggregation": 3,
              "showAnalytics": true,
              "title": "% Processor Time (_Total)",
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "timechart",
              "chartSettings": {
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 1,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true,
                      "maximumFractionDigits": 2
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "name": "query - 4",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let trend = \r\nPerf           \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"Processor\" and CounterName == \"% Processor Time\" and InstanceName == \"_Total\" \r\n| make-series Average = round(avg(CounterValue), 2) default = 0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step ({TimeRange:end} - {TimeRange:start})/100 by Computer     \r\n| project Computer, ['Trend'] = Average; \r\n\r\nPerf\r\n| where Computer in ({Computer})\r\n| where ObjectName == \"Processor\" and CounterName == \"% Processor Time\" and InstanceName == \"_Total\" \r\n| summarize Average=round(avg(CounterValue),2),StDev=round(stdevp(CounterValue),2), percentiles(CounterValue,50,75,95) by Computer\r\n| join (trend) on Computer\r\n| extend Status = case (\r\n                  Average > 80, \"Critical\",\r\n                  Average > 50, \"Warning\",\r\n                  Average <= 50, \"Healthy\", \"Unknown\"\r\n)\r\n| project Status, Computer, [\"Avg.\"]=Average,StDev,p50=round(percentile_CounterValue_50,2),p75=round(percentile_CounterValue_75,2),p95=round(percentile_CounterValue_95,2), Trend\r\n| sort by [\"Avg.\"]",
              "size": 0,
              "showAnalytics": true,
              "title": "% Processor Time (_Total) thresholds (Warning=50; High=80)",
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Status",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Healthy",
                          "representation": "success",
                          "text": "{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Warning",
                          "representation": "2",
                          "text": "{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Critical",
                          "representation": "critical",
                          "text": "{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "unknown",
                          "text": "{1}"
                        }
                      ],
                      "customColumnWidthSetting": "11ch"
                    }
                  },
                  {
                    "columnMatch": "Computer",
                    "formatter": 0,
                    "formatOptions": {
                      "customColumnWidthSetting": "28ch"
                    }
                  },
                  {
                    "columnMatch": "Avg.",
                    "formatter": 8,
                    "formatOptions": {
                      "min": -10,
                      "max": 100,
                      "palette": "blue",
                      "customColumnWidthSetting": "12ch"
                    },
                    "numberFormat": {
                      "unit": 0,
                      "options": {
                        "style": "decimal",
                        "maximumFractionDigits": 2
                      }
                    }
                  },
                  {
                    "columnMatch": "StDev",
                    "formatter": 8,
                    "formatOptions": {
                      "min": -10,
                      "max": 100,
                      "palette": "orange",
                      "customColumnWidthSetting": "11ch"
                    },
                    "numberFormat": {
                      "unit": 0,
                      "options": {
                        "style": "decimal",
                        "maximumFractionDigits": 2
                      }
                    }
                  },
                  {
                    "columnMatch": "p50",
                    "formatter": 0,
                    "formatOptions": {
                      "customColumnWidthSetting": "9ch"
                    }
                  },
                  {
                    "columnMatch": "p75",
                    "formatter": 0,
                    "formatOptions": {
                      "customColumnWidthSetting": "9ch"
                    }
                  },
                  {
                    "columnMatch": "p95",
                    "formatter": 0,
                    "formatOptions": {
                      "customColumnWidthSetting": "9ch"
                    }
                  },
                  {
                    "columnMatch": "Trend",
                    "formatter": 21,
                    "formatOptions": {
                      "min": 0,
                      "max": 100,
                      "palette": "green"
                    }
                  }
                ]
              },
              "sortBy": []
            },
            "customWidth": "50",
            "name": "query - 9",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 1,
            "content": {
              "json": "## Memory"
            },
            "customWidth": "10",
            "name": "TextMemory"
          },
          {
            "type": 11,
            "content": {
              "version": "LinkItem/1.0",
              "style": "nav",
              "links": [
                {
                  "id": "81127041-6e94-4b0d-bdc2-adeae8549187",
                  "cellValue": "ParametersOS",
                  "linkTarget": "step",
                  "linkLabel": "Go back",
                  "style": "secondary"
                }
              ]
            },
            "customWidth": "90",
            "name": "GoBackMemory"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "Perf \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"Memory\" and CounterName == \"Available MBytes\" \r\n| summarize AvailableMBytes = round(avg(CounterValue),2) by Computer, bin(TimeGenerated, ({TimeRange:end} - {TimeRange:start})/100)\r\n| render timechart\r\n\r\n",
              "size": 0,
              "aggregation": 3,
              "showAnalytics": true,
              "title": "Available MBytes",
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "timechart",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "AvailableMBytes",
                    "formatter": 0,
                    "formatOptions": {
                      "showIcon": true
                    },
                    "numberFormat": {
                      "unit": 4,
                      "options": {
                        "style": "decimal",
                        "useGrouping": false
                      }
                    }
                  }
                ]
              },
              "chartSettings": {
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 4,
                    "options": {
                      "style": "decimal",
                      "maximumFractionDigits": 2
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "name": "query - 5",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let trend = \r\nPerf           \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"Memory\" and CounterName == \"Available MBytes\"\r\n| make-series Average = round(avg(CounterValue), 3) default = 0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step ({TimeRange:end} - {TimeRange:start})/100 by Computer     \r\n| project Computer, ['Trend'] = Average; \r\n\r\nPerf\r\n| where Computer in ({Computer})\r\n| where ObjectName == \"Memory\" and CounterName == \"Available MBytes\"\r\n| summarize [\"Available MBytes\"]=round(avg(CounterValue),2),StDev=round(stdevp(CounterValue),2), percentiles(CounterValue,50,75,95) by Computer\r\n| join (trend) on Computer\r\n| extend Status = case (\r\n                  [\"Available MBytes\"] > 4096, \"Healthy\",\r\n                  [\"Available MBytes\"] >= 1024, \"Warning\",\r\n                  [\"Available MBytes\"] < 1024, \"Critical\", \"Unknown\"\r\n)\r\n| project Status, Computer, [\"Avg.\"]=[\"Available MBytes\"],StDev,p50=round(percentile_CounterValue_50,2),p75=round(percentile_CounterValue_75,2),p95=round(percentile_CounterValue_95,2), Trend\r\n| sort by [\"Avg.\"] asc\r\n",
              "size": 0,
              "showAnalytics": true,
              "title": "Available MBytes thresholds (Warning < 4 GB; Critical < 1 GB)",
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Status",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Healthy",
                          "representation": "success",
                          "text": "{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Warning",
                          "representation": "2",
                          "text": "{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Critical",
                          "representation": "critical",
                          "text": "{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "Unknown",
                          "text": "{1}"
                        }
                      ],
                      "customColumnWidthSetting": "11ch"
                    }
                  },
                  {
                    "columnMatch": "Computer",
                    "formatter": 0,
                    "formatOptions": {
                      "customColumnWidthSetting": "28ch"
                    }
                  },
                  {
                    "columnMatch": "Avg.",
                    "formatter": 8,
                    "formatOptions": {
                      "min": 0,
                      "palette": "blue",
                      "compositeBarSettings": {
                        "labelText": "",
                        "columnSettings": []
                      },
                      "customColumnWidthSetting": "10ch"
                    },
                    "numberFormat": {
                      "unit": 38,
                      "options": {
                        "style": "decimal",
                        "maximumFractionDigits": 2
                      }
                    }
                  },
                  {
                    "columnMatch": "StDev",
                    "formatter": 8,
                    "formatOptions": {
                      "min": 0,
                      "palette": "orange",
                      "customColumnWidthSetting": "11ch"
                    },
                    "numberFormat": {
                      "unit": 4,
                      "options": {
                        "style": "decimal",
                        "maximumFractionDigits": 2
                      }
                    }
                  },
                  {
                    "columnMatch": "p50",
                    "formatter": 0,
                    "formatOptions": {
                      "customColumnWidthSetting": "9ch"
                    },
                    "numberFormat": {
                      "unit": 4,
                      "options": {
                        "style": "decimal",
                        "maximumFractionDigits": 2
                      }
                    }
                  },
                  {
                    "columnMatch": "p75",
                    "formatter": 0,
                    "formatOptions": {
                      "customColumnWidthSetting": "9ch"
                    },
                    "numberFormat": {
                      "unit": 4,
                      "options": {
                        "style": "decimal",
                        "maximumFractionDigits": 2
                      }
                    }
                  },
                  {
                    "columnMatch": "p95",
                    "formatter": 0,
                    "formatOptions": {
                      "customColumnWidthSetting": "9ch"
                    },
                    "numberFormat": {
                      "unit": 4,
                      "options": {
                        "style": "decimal",
                        "maximumFractionDigits": 2
                      }
                    }
                  },
                  {
                    "columnMatch": "Trend",
                    "formatter": 21,
                    "formatOptions": {
                      "palette": "green"
                    }
                  }
                ]
              },
              "sortBy": []
            },
            "customWidth": "50",
            "name": "query - 9 - Copy",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "Perf \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"Memory\" and CounterName == \"Pages/sec\" \r\n| summarize [\"Pages/sec\"] = round(avg(CounterValue),2) by Computer, bin(TimeGenerated, ({TimeRange:end} - {TimeRange:start})/100)\r\n| render timechart",
              "size": 0,
              "aggregation": 3,
              "showAnalytics": true,
              "title": "Pages/sec",
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "timechart",
              "chartSettings": {
                "xAxis": "TimeGenerated"
              }
            },
            "customWidth": "50",
            "name": "query - 9",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let trend = \r\nPerf           \r\n| where Computer in ({Computer}) \r\n| where ObjectName == \"Memory\" and CounterName == \"Pages/sec\"\r\n| make-series Average = round(avg(CounterValue), 2) default = 0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step ({TimeRange:end} - {TimeRange:start})/100 by Computer     \r\n| project Computer, ['Trend'] = Average; \r\n\r\nPerf\r\n| where Computer in ({Computer}) \r\n| where ObjectName == \"Memory\" and CounterName == \"Pages/sec\"\r\n| summarize Average=round(avg(CounterValue),2),StDev=round(stdevp(CounterValue),2), percentiles(CounterValue,50,75,95) by Computer\r\n| join (trend) on Computer\r\n| extend Status = case (\r\n                  Average > 2500, \"Critical\",\r\n                  Average > 1000, \"Warning\",\r\n                  Average <= 1000, \"Healthy\", \"Unknown\"\r\n)\r\n\r\n| project Status, Computer, [\"Avg.\"]=Average,StDev,p50=round(percentile_CounterValue_50,2),p75=round(percentile_CounterValue_75,2),p95=round(percentile_CounterValue_95,2), Trend\r\n| sort by [\"Avg.\"]",
              "size": 0,
              "showAnalytics": true,
              "title": "Pages/sec thresholds (Warning>1000; High>2500)",
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Status",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Healthy",
                          "representation": "success",
                          "text": "{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Warning",
                          "representation": "2",
                          "text": "{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Critical",
                          "representation": "critical",
                          "text": "{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "unknown",
                          "text": "{1}"
                        }
                      ],
                      "customColumnWidthSetting": "11ch"
                    }
                  },
                  {
                    "columnMatch": "Computer",
                    "formatter": 0,
                    "formatOptions": {
                      "customColumnWidthSetting": "28ch"
                    }
                  },
                  {
                    "columnMatch": "Avg.",
                    "formatter": 8,
                    "formatOptions": {
                      "min": 0,
                      "palette": "blue",
                      "customColumnWidthSetting": "10ch"
                    }
                  },
                  {
                    "columnMatch": "StDev",
                    "formatter": 8,
                    "formatOptions": {
                      "min": 0,
                      "palette": "orange",
                      "customColumnWidthSetting": "11ch"
                    },
                    "numberFormat": {
                      "unit": 0,
                      "options": {
                        "style": "decimal",
                        "maximumFractionDigits": 2
                      }
                    }
                  },
                  {
                    "columnMatch": "p50",
                    "formatter": 0,
                    "formatOptions": {
                      "customColumnWidthSetting": "9ch"
                    }
                  },
                  {
                    "columnMatch": "p75",
                    "formatter": 0,
                    "formatOptions": {
                      "customColumnWidthSetting": "9ch"
                    }
                  },
                  {
                    "columnMatch": "p95",
                    "formatter": 0,
                    "formatOptions": {
                      "customColumnWidthSetting": "9ch"
                    }
                  },
                  {
                    "columnMatch": "Trend",
                    "formatter": 21,
                    "formatOptions": {
                      "palette": "green"
                    }
                  },
                  {
                    "columnMatch": "Average",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "blue"
                    },
                    "numberFormat": {
                      "unit": 0,
                      "options": {
                        "style": "decimal",
                        "maximumFractionDigits": 2
                      }
                    }
                  }
                ]
              },
              "sortBy": []
            },
            "customWidth": "50",
            "name": "query - 9 - Copy",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "Perf \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"Paging File\" and CounterName == \"% Usage\" and InstanceName==\"_Total\"\r\n| summarize [\"% Usage\"] = round(avg(CounterValue),2) by Computer, bin(TimeGenerated, ({TimeRange:end} - {TimeRange:start})/100)\r\n| render timechart",
              "size": 0,
              "aggregation": 3,
              "showAnalytics": true,
              "title": "Paging File\\% Usage",
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "timechart",
              "chartSettings": {
                "xAxis": "TimeGenerated",
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 1,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true,
                      "maximumFractionDigits": 2
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "name": "QueryPagingFile",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let trend = \r\nPerf           \r\n| where Computer in ({Computer}) \r\n| where ObjectName == \"Paging File\" and CounterName == \"% Usage\"\r\n| make-series Average = round(avg(CounterValue), 2) default = 0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step ({TimeRange:end} - {TimeRange:start})/100 by Computer     \r\n| project Computer, ['Trend'] = Average; \r\n\r\nPerf\r\n| where Computer in ({Computer}) \r\n| where ObjectName == \"Paging File\" and CounterName == \"% Usage\"\r\n| summarize Average=round(avg(CounterValue),2),StDev=round(stdevp(CounterValue),2), percentiles(CounterValue,50,75,95) by Computer\r\n| join (trend) on Computer\r\n| extend Status = case (\r\n                  Average > 75, \"Critical\",\r\n                  Average > 50, \"Warning\",\r\n                  Average <= 50, \"Healthy\", \"Unknown\"\r\n)\r\n\r\n| project Status, Computer, [\"Avg.\"]=Average,StDev,p50=round(percentile_CounterValue_50,2),p75=round(percentile_CounterValue_75,2),p95=round(percentile_CounterValue_95,2), Trend\r\n| sort by [\"Avg.\"] ",
              "size": 0,
              "showAnalytics": true,
              "title": "Paging File\\% Usage thresholds (Warning>50; High>75)",
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Status",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Healthy",
                          "representation": "success",
                          "text": "{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Warning",
                          "representation": "2",
                          "text": "{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Critical",
                          "representation": "critical",
                          "text": "{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "unknown",
                          "text": "{1}"
                        }
                      ],
                      "customColumnWidthSetting": "11ch"
                    }
                  },
                  {
                    "columnMatch": "Computer",
                    "formatter": 0,
                    "formatOptions": {
                      "customColumnWidthSetting": "28ch"
                    }
                  },
                  {
                    "columnMatch": "Avg.",
                    "formatter": 8,
                    "formatOptions": {
                      "min": -10,
                      "max": 100,
                      "palette": "blue",
                      "customColumnWidthSetting": "10ch"
                    },
                    "numberFormat": {
                      "unit": 0,
                      "options": {
                        "style": "decimal",
                        "maximumFractionDigits": 2
                      }
                    }
                  },
                  {
                    "columnMatch": "StDev",
                    "formatter": 8,
                    "formatOptions": {
                      "min": -10,
                      "max": 100,
                      "palette": "orange",
                      "customColumnWidthSetting": "11ch"
                    },
                    "numberFormat": {
                      "unit": 0,
                      "options": {
                        "style": "decimal",
                        "maximumFractionDigits": 2
                      }
                    }
                  },
                  {
                    "columnMatch": "p50",
                    "formatter": 0,
                    "formatOptions": {
                      "customColumnWidthSetting": "9ch"
                    }
                  },
                  {
                    "columnMatch": "p75",
                    "formatter": 0,
                    "formatOptions": {
                      "customColumnWidthSetting": "9ch"
                    }
                  },
                  {
                    "columnMatch": "p95",
                    "formatter": 0,
                    "formatOptions": {
                      "customColumnWidthSetting": "9ch"
                    }
                  },
                  {
                    "columnMatch": "Trend",
                    "formatter": 21,
                    "formatOptions": {
                      "min": 0,
                      "max": 100,
                      "palette": "green"
                    }
                  }
                ]
              },
              "sortBy": []
            },
            "customWidth": "50",
            "name": "QueryPagingFileThresholds",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 1,
            "content": {
              "json": "## Logical Disk"
            },
            "customWidth": "10",
            "name": "TextLogicalDisk"
          },
          {
            "type": 11,
            "content": {
              "version": "LinkItem/1.0",
              "style": "nav",
              "links": [
                {
                  "id": "bf57f64e-f7c1-4f66-a307-9f1234991b9a",
                  "cellValue": "ParametersOS",
                  "linkTarget": "step",
                  "linkLabel": "Go back",
                  "style": "secondary"
                }
              ]
            },
            "customWidth": "90",
            "name": "GoBackLogicalDisk"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "Perf\r\n| where Computer in ({Computer})\r\n| where ObjectName == \"LogicalDisk\" and CounterName == \"Free Megabytes\" and strlen(InstanceName) == 2\r\n| extend disk = strcat(InstanceName, \" (\",Computer,\")\")\r\n| summarize [\"Free Megabytes\"] = round(avg(CounterValue),2) by disk, bin(TimeGenerated, ({TimeRange:end} - {TimeRange:start})/100)\r\n| render timechart\r\n\r\n\r\n",
              "size": 0,
              "aggregation": 3,
              "showAnalytics": true,
              "title": "Free Megabytes",
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "chartSettings": {
                "xAxis": "TimeGenerated",
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 4,
                    "options": {
                      "style": "decimal",
                      "maximumFractionDigits": 2
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "name": "query - 6",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let trend = \r\nPerf           \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"LogicalDisk\" and CounterName == \"Free Megabytes\" and strlen(InstanceName) == 2\r\n| extend disk = strcat(InstanceName, \" - \",Computer )\r\n| make-series Average = round(avg(CounterValue), 3) default = 0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step ({TimeRange:end} - {TimeRange:start})/100 by disk     \r\n| project disk, ['Trend'] = Average; \r\n\r\nPerf\r\n| where Computer in ({Computer})\r\n| where ObjectName == \"LogicalDisk\" and CounterName == \"Free Megabytes\" and strlen(InstanceName) == 2\r\n| extend disk = strcat(InstanceName, \" - \",Computer )\r\n| summarize [\"Free Megabytes\"]=round(avg(CounterValue),2),StDev=round(stdevp(CounterValue),2), percentiles(CounterValue,50,75,95) by disk,Computer,InstanceName\r\n| join (trend) on disk\r\n| extend Status = case (\r\n                  [\"Free Megabytes\"] > 5120, \"Healthy\",\r\n                  [\"Free Megabytes\"] > 3072, \"Warning\",\r\n                  [\"Free Megabytes\"] <= 3072, \"Critical\", \"Unknown\"\r\n)\r\n| project Status, Computer,Disk=InstanceName, [\"Avg.\"]=[\"Free Megabytes\"],StDev,p50=round(percentile_CounterValue_50,2),p75=round(percentile_CounterValue_75,2),p95=round(percentile_CounterValue_95,2), Trend\r\n| sort by [\"Avg.\"] asc ",
              "size": 0,
              "showAnalytics": true,
              "title": "Free Megabytes thresholds (Warning<5 GB; Critical<3 GB)",
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Status",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Healthy",
                          "representation": "success",
                          "text": "{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Warning",
                          "representation": "2",
                          "text": "{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Critical",
                          "representation": "critical",
                          "text": "{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "unknown",
                          "text": "{1}"
                        }
                      ],
                      "customColumnWidthSetting": "11ch"
                    }
                  },
                  {
                    "columnMatch": "Computer",
                    "formatter": 0,
                    "formatOptions": {
                      "customColumnWidthSetting": "28ch"
                    }
                  },
                  {
                    "columnMatch": "Disk",
                    "formatter": 0,
                    "formatOptions": {
                      "customColumnWidthSetting": "9ch"
                    }
                  },
                  {
                    "columnMatch": "Avg.",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "blue",
                      "customColumnWidthSetting": "10ch"
                    },
                    "numberFormat": {
                      "unit": 4,
                      "options": {
                        "style": "decimal",
                        "maximumFractionDigits": 2
                      }
                    }
                  },
                  {
                    "columnMatch": "StDev",
                    "formatter": 8,
                    "formatOptions": {
                      "min": -10,
                      "max": 100,
                      "palette": "orange",
                      "customColumnWidthSetting": "11ch"
                    },
                    "numberFormat": {
                      "unit": 4,
                      "options": {
                        "style": "decimal",
                        "maximumFractionDigits": 2
                      }
                    }
                  },
                  {
                    "columnMatch": "p50",
                    "formatter": 0,
                    "formatOptions": {
                      "customColumnWidthSetting": "10ch"
                    },
                    "numberFormat": {
                      "unit": 4,
                      "options": {
                        "style": "decimal",
                        "maximumFractionDigits": 2
                      }
                    }
                  },
                  {
                    "columnMatch": "p75",
                    "formatter": 0,
                    "formatOptions": {
                      "customColumnWidthSetting": "10ch"
                    },
                    "numberFormat": {
                      "unit": 4,
                      "options": {
                        "style": "decimal",
                        "maximumFractionDigits": 2
                      }
                    }
                  },
                  {
                    "columnMatch": "p95",
                    "formatter": 0,
                    "formatOptions": {
                      "customColumnWidthSetting": "10ch"
                    },
                    "numberFormat": {
                      "unit": 4,
                      "options": {
                        "style": "decimal",
                        "maximumFractionDigits": 2
                      }
                    }
                  },
                  {
                    "columnMatch": "Trend",
                    "formatter": 21,
                    "formatOptions": {
                      "palette": "green",
                      "customColumnWidthSetting": "25ch"
                    }
                  }
                ]
              },
              "sortBy": []
            },
            "customWidth": "50",
            "name": "QueryFreeMegabytesThresholds",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "Perf\r\n| where Computer in ({Computer})\r\n| where ObjectName == \"LogicalDisk\"  and CounterName == \"Avg. Disk sec/Read\" and strlen(InstanceName) == 2 \r\n| extend disk = strcat(InstanceName, \" (\",Computer,\")\")\r\n| summarize Seconds = avg(CounterValue) by disk, bin(TimeGenerated, ({TimeRange:end} - {TimeRange:start})/100)\r\n| render timechart\r\n\r\n\r\n",
              "size": 0,
              "aggregation": 3,
              "showAnalytics": true,
              "title": "Avg. Disk sec/Read",
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "timechart",
              "chartSettings": {
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 24,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true,
                      "maximumFractionDigits": 2
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "name": "QueryAvgDiskSecRead",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let trend = \r\nPerf           \r\n| where Computer in ({Computer}) \r\n| where ObjectName == \"LogicalDisk\" and CounterName == \"Avg. Disk sec/Read\" and strlen(InstanceName) == 2 \r\n| extend Disco = strcat(InstanceName, \" - \",Computer )\r\n| make-series AVGMilliSeconds = round(avg(CounterValue)*1000,2) default = 0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step ({TimeRange:end} - {TimeRange:start})/100 by Disco     \r\n| project Disco, ['Trend'] = AVGMilliSeconds; \r\n\r\nPerf\r\n| where Computer in ({Computer})\r\n| where ObjectName == \"LogicalDisk\" and CounterName == \"Avg. Disk sec/Read\" and strlen(InstanceName) == 2\r\n| extend Disco = strcat(InstanceName, \" - \",Computer )\r\n| summarize AVGMilliSeconds=round(avg(CounterValue)*1000,2),StDev=round(stdevp(CounterValue)*1000,2), percentiles(CounterValue,50,75,95)\r\n by Disco,Computer,InstanceName\r\n| join (trend) on Disco\r\n| extend Status = case (\r\n                  AVGMilliSeconds > 25, \"Critical\",\r\n                  AVGMilliSeconds > 15, \"Warning\",\r\n                  AVGMilliSeconds <= 15, \"Healthy\", \"Unknown\"\r\n)\r\n\r\n| project Status, Computer,Disk=InstanceName, [\"Avg.\"]=AVGMilliSeconds,StDev,p50=round(percentile_CounterValue_50*1000,2),p75=round(percentile_CounterValue_75*1000,2),p95=round(percentile_CounterValue_95*1000,2)\r\n, Trend\r\n| sort by [\"Avg.\"] desc ",
              "size": 0,
              "showAnalytics": true,
              "title": "Avg. Disk sec/Read thresholds (Warning>15ms; Critical>25ms)",
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Status",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Healthy",
                          "representation": "success",
                          "text": "{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Warning",
                          "representation": "2",
                          "text": "{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Critical",
                          "representation": "critical",
                          "text": "{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "unknown",
                          "text": "{1}"
                        }
                      ],
                      "customColumnWidthSetting": "11ch"
                    }
                  },
                  {
                    "columnMatch": "Computer",
                    "formatter": 0,
                    "formatOptions": {
                      "customColumnWidthSetting": "26ch"
                    }
                  },
                  {
                    "columnMatch": "Disk",
                    "formatter": 0,
                    "formatOptions": {
                      "customColumnWidthSetting": "9ch"
                    }
                  },
                  {
                    "columnMatch": "Avg.",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "blue",
                      "customColumnWidthSetting": "9ch"
                    },
                    "numberFormat": {
                      "unit": 23,
                      "options": {
                        "style": "decimal"
                      }
                    }
                  },
                  {
                    "columnMatch": "StDev",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "orange",
                      "customColumnWidthSetting": "10ch"
                    },
                    "numberFormat": {
                      "unit": 23,
                      "options": {
                        "style": "decimal",
                        "maximumFractionDigits": 2
                      }
                    }
                  },
                  {
                    "columnMatch": "p50",
                    "formatter": 0,
                    "formatOptions": {
                      "customColumnWidthSetting": "9ch"
                    },
                    "numberFormat": {
                      "unit": 23,
                      "options": {
                        "style": "decimal"
                      }
                    }
                  },
                  {
                    "columnMatch": "p75",
                    "formatter": 0,
                    "formatOptions": {
                      "customColumnWidthSetting": "9ch"
                    },
                    "numberFormat": {
                      "unit": 23,
                      "options": {
                        "style": "decimal"
                      }
                    }
                  },
                  {
                    "columnMatch": "p95",
                    "formatter": 0,
                    "formatOptions": {
                      "customColumnWidthSetting": "9ch"
                    },
                    "numberFormat": {
                      "unit": 23,
                      "options": {
                        "style": "decimal"
                      }
                    }
                  },
                  {
                    "columnMatch": "Trend",
                    "formatter": 21,
                    "formatOptions": {
                      "min": 0,
                      "max": 25,
                      "palette": "green",
                      "customColumnWidthSetting": "25ch"
                    }
                  }
                ]
              },
              "sortBy": []
            },
            "customWidth": "50",
            "name": "QueryAvgDiskSecReadThresholds",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "Perf\r\n| where Computer in ({Computer})\r\n| where  ObjectName == \"LogicalDisk\" and CounterName == \"Avg. Disk sec/Write\" and strlen(InstanceName) == 2\r\n| extend disk = strcat(InstanceName, \" (\",Computer,\")\")\r\n| summarize Seconds = avg(CounterValue) by disk, bin(TimeGenerated, ({TimeRange:end} - {TimeRange:start})/100)\r\n| render timechart\r\n\r\n\r\n\r\n\r\n",
              "size": 0,
              "aggregation": 3,
              "showAnalytics": true,
              "title": "Avg. Disk sec/Write",
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "timechart",
              "chartSettings": {
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 24,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true,
                      "maximumFractionDigits": 2
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "name": "query - 6 - Copy - Copy",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let trend = \r\nPerf           \r\n| where Computer in ({Computer}) \r\n| where ObjectName == \"LogicalDisk\" and CounterName == \"Avg. Disk sec/Write\" and strlen(InstanceName) == 2\r\n| extend Disco = strcat(InstanceName, \" - \",Computer )\r\n| make-series AVGMilliSeconds = round(avg(CounterValue)*1000,2) default = 0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step ({TimeRange:end} - {TimeRange:start})/100 by Disco     \r\n| project Disco, ['Trend'] = AVGMilliSeconds; \r\n\r\nPerf\r\n| where Computer in ({Computer})\r\n| where ObjectName == \"LogicalDisk\" and CounterName == \"Avg. Disk sec/Write\" and strlen(InstanceName) == 2  \r\n| extend Disco = strcat(InstanceName, \" - \",Computer )\r\n| summarize AVGMilliSeconds=round(avg(CounterValue)*1000,2),StDev=round(stdevp(CounterValue)*1000,2), percentiles(CounterValue,50,75,95)\r\n by Disco,Computer,InstanceName\r\n| join (trend) on Disco\r\n| extend Status = case (\r\n                  AVGMilliSeconds > 25, \"Critical\",\r\n                  AVGMilliSeconds > 15, \"Warning\",\r\n                  AVGMilliSeconds <= 15, \"Healthy\", \"Unknown\"\r\n)\r\n\r\n| project Status, Computer,Disk=InstanceName, [\"Avg.\"]=AVGMilliSeconds,StDev,p50=round(percentile_CounterValue_50*1000,2),p75=round(percentile_CounterValue_75*1000,2),p95=round(percentile_CounterValue_95*1000,2)\r\n, Trend\r\n| sort by [\"Avg.\"] desc ",
              "size": 0,
              "showAnalytics": true,
              "title": "Avg. Disk sec/Write thresholds (Warning>15ms; Critical>25ms)",
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Status",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Healthy",
                          "representation": "success",
                          "text": "{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Warning",
                          "representation": "2",
                          "text": "{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Critical",
                          "representation": "critical",
                          "text": "{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "unknown",
                          "text": "{1}"
                        }
                      ],
                      "customColumnWidthSetting": "11ch"
                    }
                  },
                  {
                    "columnMatch": "Computer",
                    "formatter": 0,
                    "formatOptions": {
                      "customColumnWidthSetting": "28ch"
                    }
                  },
                  {
                    "columnMatch": "Disk",
                    "formatter": 0,
                    "formatOptions": {
                      "customColumnWidthSetting": "9ch"
                    }
                  },
                  {
                    "columnMatch": "Avg.",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "blue",
                      "customColumnWidthSetting": "9ch"
                    },
                    "numberFormat": {
                      "unit": 23,
                      "options": {
                        "style": "decimal"
                      }
                    }
                  },
                  {
                    "columnMatch": "StDev",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "orange",
                      "customColumnWidthSetting": "10ch"
                    },
                    "numberFormat": {
                      "unit": 23,
                      "options": {
                        "style": "decimal",
                        "maximumFractionDigits": 2
                      }
                    }
                  },
                  {
                    "columnMatch": "p50",
                    "formatter": 0,
                    "formatOptions": {
                      "customColumnWidthSetting": "9ch"
                    },
                    "numberFormat": {
                      "unit": 23,
                      "options": {
                        "style": "decimal",
                        "maximumFractionDigits": 2
                      }
                    }
                  },
                  {
                    "columnMatch": "p75",
                    "formatter": 0,
                    "formatOptions": {
                      "customColumnWidthSetting": "9ch"
                    },
                    "numberFormat": {
                      "unit": 22,
                      "options": {
                        "style": "decimal",
                        "maximumFractionDigits": 2
                      }
                    }
                  },
                  {
                    "columnMatch": "p95",
                    "formatter": 0,
                    "formatOptions": {
                      "customColumnWidthSetting": "9ch"
                    },
                    "numberFormat": {
                      "unit": 23,
                      "options": {
                        "style": "decimal",
                        "maximumFractionDigits": 2
                      }
                    }
                  },
                  {
                    "columnMatch": "Trend",
                    "formatter": 21,
                    "formatOptions": {
                      "palette": "green",
                      "customColumnWidthSetting": "25ch"
                    }
                  }
                ]
              },
              "sortBy": []
            },
            "customWidth": "50",
            "name": "QueryAvgDiskSecWriteThresholds",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "Perf\r\n| where Computer in ({Computer})\r\n| where  ObjectName == \"LogicalDisk\" and CounterName == \"Avg. Disk Queue Length\" and strlen(InstanceName) == 2\r\n| extend disk = strcat(InstanceName, \" (\",Computer,\")\")\r\n| summarize queue = avg(CounterValue) by disk, bin(TimeGenerated, ({TimeRange:end} - {TimeRange:start})/100)\r\n| render timechart\r\n\r\n\r\n\r\n\r\n",
              "size": 0,
              "aggregation": 3,
              "showAnalytics": true,
              "title": "Avg. Disk Queue Length",
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "timechart",
              "chartSettings": {
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 17,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "name": "QueryAvgDiskQueueLength",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let trend = \r\nPerf           \r\n| where Computer in ({Computer}) \r\n| where ObjectName == \"LogicalDisk\" and CounterName == \"Avg. Disk Queue Length\" and strlen(InstanceName) == 2\r\n| extend Disco = strcat(InstanceName, \" - \",Computer )\r\n| make-series queue = round(avg(CounterValue),2) default = 0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step ({TimeRange:end} - {TimeRange:start})/100 by Disco     \r\n| project Disco, ['Trend'] = queue; \r\n\r\nPerf\r\n| where Computer in ({Computer})\r\n| where ObjectName == \"LogicalDisk\" and CounterName == \"Avg. Disk Queue Length\" and strlen(InstanceName) == 2  \r\n| extend Disco = strcat(InstanceName, \" - \",Computer )\r\n| summarize queue=round(avg(CounterValue),2),StDev=round(stdevp(CounterValue),2), percentiles(CounterValue,50,75,95)\r\n by Disco,Computer,InstanceName\r\n| join (trend) on Disco\r\n| extend Status = case (\r\n                  queue > 5, \"Critical\",\r\n                  queue > 2, \"Warning\",\r\n                  queue <= 2, \"Healthy\", \"Unknown\"\r\n)\r\n\r\n| project Status, Computer,Disk=InstanceName, [\"Avg.\"]=queue,StDev,p50=round(percentile_CounterValue_50,2),p75=round(percentile_CounterValue_75,2),p95=round(percentile_CounterValue_95,2)\r\n, Trend\r\n| sort by [\"Avg.\"] desc ",
              "size": 0,
              "showAnalytics": true,
              "title": "Avg. Disk Queue Length thresholds (Warning>2 ; Critical>5)",
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Status",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Healthy",
                          "representation": "success",
                          "text": "{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Warning",
                          "representation": "2",
                          "text": "{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Critical",
                          "representation": "critical",
                          "text": "{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "unknown",
                          "text": "{1}"
                        }
                      ],
                      "customColumnWidthSetting": "11ch"
                    }
                  },
                  {
                    "columnMatch": "Computer",
                    "formatter": 0,
                    "formatOptions": {
                      "customColumnWidthSetting": "28ch"
                    }
                  },
                  {
                    "columnMatch": "Disk",
                    "formatter": 0,
                    "formatOptions": {
                      "customColumnWidthSetting": "9ch"
                    }
                  },
                  {
                    "columnMatch": "Avg.",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "blue",
                      "customColumnWidthSetting": "11ch"
                    },
                    "numberFormat": {
                      "unit": 17,
                      "options": {
                        "style": "decimal"
                      }
                    }
                  },
                  {
                    "columnMatch": "StDev",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "orange",
                      "customColumnWidthSetting": "10ch"
                    },
                    "numberFormat": {
                      "unit": 0,
                      "options": {
                        "style": "decimal",
                        "maximumFractionDigits": 2
                      }
                    }
                  },
                  {
                    "columnMatch": "p50",
                    "formatter": 0,
                    "formatOptions": {
                      "customColumnWidthSetting": "9ch"
                    }
                  },
                  {
                    "columnMatch": "p75",
                    "formatter": 0,
                    "formatOptions": {
                      "customColumnWidthSetting": "9ch"
                    }
                  },
                  {
                    "columnMatch": "p95",
                    "formatter": 0,
                    "formatOptions": {
                      "customColumnWidthSetting": "9ch"
                    }
                  },
                  {
                    "columnMatch": "Trend",
                    "formatter": 21,
                    "formatOptions": {
                      "palette": "green",
                      "customColumnWidthSetting": "25ch"
                    }
                  }
                ]
              },
              "sortBy": []
            },
            "customWidth": "50",
            "name": "QueryAvgDiskQueueLength",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 1,
            "content": {
              "json": "## Network"
            },
            "customWidth": "10",
            "name": "TextNetwork"
          },
          {
            "type": 11,
            "content": {
              "version": "LinkItem/1.0",
              "style": "nav",
              "links": [
                {
                  "id": "1e455251-632e-484a-b692-9774e3ccf27e",
                  "cellValue": "ParametersOS",
                  "linkTarget": "step",
                  "linkLabel": "Go back",
                  "style": "secondary"
                }
              ]
            },
            "customWidth": "90",
            "name": "GoBackNetwork"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "Perf\r\n| where Computer in ({Computer})\r\n| where  ObjectName == \"Network Interface\" and CounterName == \"Output Queue Length\"\r\n| extend nic = strcat(InstanceName, \" (\",Computer,\")\")\r\n| summarize queue = avg(CounterValue) by nic, bin(TimeGenerated, ({TimeRange:end} - {TimeRange:start})/100)\r\n| render timechart\r\n\r\n\r\n\r\n\r\n",
              "size": 0,
              "aggregation": 3,
              "showAnalytics": true,
              "title": "Network Interface\\Output Queue Length",
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "timechart",
              "chartSettings": {
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 17,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "name": "QueryNetworkOutputQueueLength",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let trend = \r\nPerf           \r\n| where Computer in ({Computer}) \r\n| where ObjectName == \"Network Interface\" and CounterName == \"Output Queue Length\"\r\n| extend nic = strcat(InstanceName, \" - \",Computer )\r\n| make-series queue=round(avg(CounterValue),2) default = 0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step ({TimeRange:end} - {TimeRange:start})/100 by nic     \r\n| project nic, ['Trend'] = queue; \r\n\r\nPerf\r\n| where Computer in ({Computer})\r\n| where ObjectName == \"Network Interface\" and CounterName == \"Output Queue Length\"\r\n| extend nic = strcat(InstanceName, \" - \",Computer )\r\n| summarize [\"Output Queue Length\"]=round(avg(CounterValue),2),StDev=round(stdevp(CounterValue),2), percentiles(CounterValue,50,75,95)\r\n by nic,Computer,InstanceName\r\n| join (trend) on nic\r\n| extend Status = case (\r\n                  [\"Output Queue Length\"] > 4, \"Critical\",\r\n                  [\"Output Queue Length\"] > 2, \"Warning\",\r\n                  [\"Output Queue Length\"] <= 2, \"Healthy\", \"Unknown\"\r\n)\r\n\r\n| project Status, Computer,NIC=InstanceName, [\"Avg.\"]=[\"Output Queue Length\"],StDev,p50=round(percentile_CounterValue_50,2),p75=round(percentile_CounterValue_75,2),p95=round(percentile_CounterValue_95,2)\r\n, Trend\r\n| sort by [\"Avg.\"] desc ",
              "size": 0,
              "showAnalytics": true,
              "title": "Network Interface\\Output Queue Length thresholds (Warning>2 ; Critical>4)",
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Status",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Healthy",
                          "representation": "success",
                          "text": "{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Warning",
                          "representation": "2",
                          "text": "{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Critical",
                          "representation": "critical",
                          "text": "{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "unknown",
                          "text": "{1}"
                        }
                      ],
                      "customColumnWidthSetting": "11ch"
                    }
                  },
                  {
                    "columnMatch": "Computer",
                    "formatter": 0,
                    "formatOptions": {
                      "customColumnWidthSetting": "28ch"
                    }
                  },
                  {
                    "columnMatch": "NIC",
                    "formatter": 0,
                    "formatOptions": {
                      "customColumnWidthSetting": "34ch"
                    }
                  },
                  {
                    "columnMatch": "Avg.",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "blue",
                      "customColumnWidthSetting": "11ch"
                    }
                  },
                  {
                    "columnMatch": "StDev",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "orange"
                    }
                  },
                  {
                    "columnMatch": "Trend",
                    "formatter": 21,
                    "formatOptions": {
                      "palette": "green",
                      "customColumnWidthSetting": "25ch"
                    }
                  }
                ]
              },
              "sortBy": []
            },
            "customWidth": "50",
            "name": "QueryOutputQueueLengthThresholds",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "Perf\r\n| where Computer in ({Computer})\r\n| where  ObjectName == \"TCPv4\" and CounterName == \"Connection Failures\"\r\n| summarize queue = avg(CounterValue) by Computer, bin(TimeGenerated, ({TimeRange:end} - {TimeRange:start})/100)\r\n| render timechart\r\n\r\n\r\n\r\n\r\n",
              "size": 0,
              "aggregation": 3,
              "showAnalytics": true,
              "title": "TCPv4\\Connection Failures",
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "timechart",
              "chartSettings": {
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 17,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "name": "QueryTCPv4ConnectionFailures",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let trend = \r\nPerf           \r\n| where Computer in ({Computer}) \r\n| where ObjectName == \"TCPv4\" and CounterName == \"Connection Failures\"\r\n| make-series failures=round(avg(CounterValue),2) default = 0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step ({TimeRange:end} - {TimeRange:start})/100 by Computer     \r\n| project ['Trend'] = failures,Computer; \r\n\r\nPerf\r\n| where Computer in ({Computer})\r\n| where  ObjectName == \"TCPv4\" and CounterName == \"Connection Failures\"\r\n| summarize failures=round(avg(CounterValue),2),StDev=round(stdevp(CounterValue),2), percentiles(CounterValue,50,75,95)\r\n by Computer\r\n| join (trend) on Computer\r\n| project Computer, [\"Avg.\"]=failures,StDev,p50=round(percentile_CounterValue_50,2),p75=round(percentile_CounterValue_75,2),p95=round(percentile_CounterValue_95,2)\r\n, Trend\r\n| sort by [\"Avg.\"] desc ",
              "size": 0,
              "showAnalytics": true,
              "title": "TCPv4\\Connection Failures ",
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Computer",
                    "formatter": 0,
                    "formatOptions": {
                      "customColumnWidthSetting": "28ch"
                    }
                  },
                  {
                    "columnMatch": "Avg.",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "blue",
                      "customColumnWidthSetting": "10ch"
                    },
                    "numberFormat": {
                      "unit": 0,
                      "options": {
                        "style": "decimal",
                        "maximumFractionDigits": 2
                      }
                    }
                  },
                  {
                    "columnMatch": "StDev",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "orange",
                      "customColumnWidthSetting": "10ch"
                    },
                    "numberFormat": {
                      "unit": 0,
                      "options": {
                        "style": "decimal",
                        "maximumFractionDigits": 2
                      }
                    }
                  },
                  {
                    "columnMatch": "p50",
                    "formatter": 0,
                    "formatOptions": {
                      "customColumnWidthSetting": "9ch"
                    }
                  },
                  {
                    "columnMatch": "p75",
                    "formatter": 0,
                    "formatOptions": {
                      "customColumnWidthSetting": "9ch"
                    }
                  },
                  {
                    "columnMatch": "p95",
                    "formatter": 0,
                    "formatOptions": {
                      "customColumnWidthSetting": "9ch"
                    }
                  },
                  {
                    "columnMatch": "Trend",
                    "formatter": 21,
                    "formatOptions": {
                      "palette": "green",
                      "customColumnWidthSetting": "25ch"
                    }
                  }
                ]
              },
              "sortBy": []
            },
            "customWidth": "50",
            "name": "QueryTCPv4ConnectionFailures",
            "styleSettings": {
              "showBorder": true
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "selectedTab",
        "comparison": "isEqualTo",
        "value": "OperatingSystem"
      },
      "name": "OperatingSystemGroup",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "ActiveDirectoryGroup",
        "items": [
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "parameters": [
                {
                  "id": "7fd398c9-6e13-4319-a8b8-3289dc423d9e",
                  "version": "KqlParameterItem/1.0",
                  "name": "Computer",
                  "type": 2,
                  "description": "Maximum number of selected computers: 10",
                  "isRequired": true,
                  "multiSelect": true,
                  "quote": "'",
                  "delimiter": ",",
                  "query": "Heartbeat\r\n| where Computer in (MyDCs)\r\n| distinct Computer\r\n| order by Computer asc",
                  "crossComponentResources": [
                    "{Workspace}"
                  ],
                  "typeSettings": {
                    "limitSelectTo": 10,
                    "additionalResourceOptions": [],
                    "showDefault": false
                  },
                  "timeContext": {
                    "durationMs": 0
                  },
                  "timeContextFromParameter": "TimeRange",
                  "queryType": 0,
                  "resourceType": "microsoft.operationalinsights/workspaces",
                  "value": [
                    "AST-Demo-DC02.contoso.com",
                    "VAST-Demo-DC01.contoso.com"
                  ]
                }
              ],
              "style": "pills",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "name": "ParametersOS"
          },
          {
            "type": 1,
            "content": {
              "json": "_To improve performance, granularity is calculated automatically to show always 100 points in these grapths. You can go to **Detailed** tab to analyze data deeply_"
            },
            "name": "text - 31"
          },
          {
            "type": 11,
            "content": {
              "version": "LinkItem/1.0",
              "style": "tabs",
              "links": [
                {
                  "id": "c64b6577-6114-4fd2-99bf-3c0bd65ca639",
                  "cellValue": "selectedTab",
                  "linkTarget": "parameter",
                  "linkLabel": "Authentications",
                  "subTarget": "Authentications",
                  "style": "link"
                },
                {
                  "id": "fa580168-39a3-4df0-b62e-21c480da2ea0",
                  "cellValue": "selectedTab",
                  "linkTarget": "parameter",
                  "linkLabel": "Directory Services",
                  "subTarget": "DirectoryServices",
                  "style": "link"
                },
                {
                  "id": "7cad82d0-8cb9-45a6-bd4d-70dba336c021",
                  "cellValue": "selectedTab",
                  "linkTarget": "parameter",
                  "linkLabel": "lsass",
                  "subTarget": "lsass",
                  "style": "link"
                },
                {
                  "id": "92be1839-9d62-44ad-8cf2-17feae1a4db9",
                  "cellValue": "selectedTab",
                  "linkTarget": "parameter",
                  "linkLabel": "DNS",
                  "subTarget": "DNS",
                  "style": "link"
                },
                {
                  "id": "5ea87a7a-45d9-4558-b8ab-bce4711db985",
                  "cellValue": "selectedTab",
                  "linkTarget": "parameter",
                  "linkLabel": "DFSRS",
                  "subTarget": "DFSRS",
                  "style": "link"
                },
                {
                  "id": "f817e270-f523-4e10-ac69-6b6e793cf80e",
                  "cellValue": "selectedTab",
                  "linkTarget": "parameter",
                  "linkLabel": "NTDS",
                  "subTarget": "NTDS",
                  "style": "link"
                }
              ]
            },
            "name": "links - 0"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "NTDSGroup",
              "items": [
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "//NTDS([\"\"])\\ATQ Outstanding Queued Requests\r\nPerf \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"NTDS\" and CounterName == \"ATQ Outstanding Queued Requests\" \r\n| summarize Used_CPU = round(avg(CounterValue),1) by Computer, bin(TimeGenerated, ({TimeRange:end} - {TimeRange:start})/100)\r\n| render timechart\r\n",
                    "size": 0,
                    "aggregation": 3,
                    "showAnalytics": true,
                    "title": "NTDS\\ATQ Outstanding Queued Requests",
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "visualization": "timechart",
                    "chartSettings": {
                      "ySettings": {
                        "numberFormatSettings": {
                          "unit": 17,
                          "options": {
                            "style": "decimal",
                            "useGrouping": true,
                            "maximumFractionDigits": 2
                          }
                        }
                      }
                    }
                  },
                  "customWidth": "50",
                  "name": "QueryATQEstimatedQueueDelay",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "//NTDS([\"\"])\\ATQ Outstanding Queued Requests\r\nlet trend = \r\nPerf \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"NTDS\" and CounterName == \"ATQ Outstanding Queued Requests\" \r\n| make-series Average = round(avg(CounterValue), 2) default = 0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step ({TimeRange:end} - {TimeRange:start})/100 by Computer     \r\n| project Computer, ['Trend'] = Average; \r\n\r\nPerf\r\n| where Computer in ({Computer})\r\n| where ObjectName == \"NTDS\" and CounterName == \"ATQ Outstanding Queued Requests\" \r\n| summarize Average=round(avg(CounterValue),2),StDev=round(stdevp(CounterValue),2), percentiles(CounterValue,50,75,95) by Computer\r\n| join (trend) on Computer\r\n| project Computer, [\"Avg.\"]=Average,StDev,p50=round(percentile_CounterValue_50,2),p75=round(percentile_CounterValue_75,2),p95=round(percentile_CounterValue_95,2), Trend\r\n| sort by [\"Avg.\"]",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "ATQ Outstanding Queued Requests",
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Computer",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "28ch"
                          }
                        },
                        {
                          "columnMatch": "Avg.",
                          "formatter": 8,
                          "formatOptions": {
                            "min": -10,
                            "max": 100,
                            "palette": "blue",
                            "customColumnWidthSetting": "12ch"
                          },
                          "numberFormat": {
                            "unit": 0,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "StDev",
                          "formatter": 8,
                          "formatOptions": {
                            "min": -10,
                            "max": 100,
                            "palette": "orange",
                            "customColumnWidthSetting": "11ch"
                          },
                          "numberFormat": {
                            "unit": 0,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "p50",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          }
                        },
                        {
                          "columnMatch": "p75",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          }
                        },
                        {
                          "columnMatch": "p95",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          }
                        },
                        {
                          "columnMatch": "Trend",
                          "formatter": 21,
                          "formatOptions": {
                            "min": 0,
                            "max": 100,
                            "palette": "green"
                          }
                        },
                        {
                          "columnMatch": "Status",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "Healthy",
                                "representation": "success",
                                "text": "{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Warning",
                                "representation": "2",
                                "text": "{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Critical",
                                "representation": "critical",
                                "text": "{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "unknown",
                                "text": "{1}"
                              }
                            ],
                            "customColumnWidthSetting": "11ch"
                          }
                        }
                      ]
                    },
                    "sortBy": []
                  },
                  "customWidth": "50",
                  "name": "TableATQEstimatedQueueDelay",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "//NTDS([\"\"])\\ATQ Outstanding Queued Requests\r\nPerf \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"NTDS\" and CounterName == \"ATQ Outstanding Queued Requests\" \r\n| summarize Used_CPU = round(avg(CounterValue),1) by Computer, bin(TimeGenerated, ({TimeRange:end} - {TimeRange:start})/100)\r\n| render timechart\r\n",
                    "size": 0,
                    "aggregation": 3,
                    "showAnalytics": true,
                    "title": "NTDS\\ATQ Outstanding Queued Requests",
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "visualization": "timechart",
                    "chartSettings": {
                      "ySettings": {
                        "numberFormatSettings": {
                          "unit": 17,
                          "options": {
                            "style": "decimal",
                            "useGrouping": true,
                            "maximumFractionDigits": 2
                          }
                        }
                      }
                    }
                  },
                  "customWidth": "50",
                  "name": "QueryATQOutstandingQueuedRequests",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "//NTDS([\"\"])\\ATQ Outstanding Queued Requests\r\nlet trend = \r\nPerf \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"NTDS\" and CounterName == \"ATQ Outstanding Queued Requests\" \r\n| make-series Average = round(avg(CounterValue), 2) default = 0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step ({TimeRange:end} - {TimeRange:start})/100 by Computer     \r\n| project Computer, ['Trend'] = Average; \r\n\r\nPerf\r\n| where Computer in ({Computer})\r\n| where ObjectName == \"NTDS\" and CounterName == \"ATQ Outstanding Queued Requests\" \r\n| summarize Average=round(avg(CounterValue),2),StDev=round(stdevp(CounterValue),2), percentiles(CounterValue,50,75,95) by Computer\r\n| join (trend) on Computer\r\n| project Computer, [\"Avg.\"]=Average,StDev,p50=round(percentile_CounterValue_50,2),p75=round(percentile_CounterValue_75,2),p95=round(percentile_CounterValue_95,2), Trend\r\n| sort by [\"Avg.\"]",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "ATQ Outstanding Queued Requests",
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Computer",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "28ch"
                          }
                        },
                        {
                          "columnMatch": "Avg.",
                          "formatter": 8,
                          "formatOptions": {
                            "min": -10,
                            "max": 100,
                            "palette": "blue",
                            "customColumnWidthSetting": "12ch"
                          },
                          "numberFormat": {
                            "unit": 0,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "StDev",
                          "formatter": 8,
                          "formatOptions": {
                            "min": -10,
                            "max": 100,
                            "palette": "orange",
                            "customColumnWidthSetting": "11ch"
                          },
                          "numberFormat": {
                            "unit": 0,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "p50",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          }
                        },
                        {
                          "columnMatch": "p75",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          }
                        },
                        {
                          "columnMatch": "p95",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          }
                        },
                        {
                          "columnMatch": "Trend",
                          "formatter": 21,
                          "formatOptions": {
                            "min": 0,
                            "max": 100,
                            "palette": "green"
                          }
                        },
                        {
                          "columnMatch": "Status",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "Healthy",
                                "representation": "success",
                                "text": "{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Warning",
                                "representation": "2",
                                "text": "{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Critical",
                                "representation": "critical",
                                "text": "{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "unknown",
                                "text": "{1}"
                              }
                            ],
                            "customColumnWidthSetting": "11ch"
                          }
                        }
                      ]
                    },
                    "sortBy": []
                  },
                  "customWidth": "50",
                  "name": "TableATQOutstandingQueuedRequests",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "//NTDS([\"\"])\\ATQ Request Latency\r\nPerf \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"NTDS\" and CounterName == \"ATQ Request Latency\" \r\n| summarize Used_CPU = round(avg(CounterValue),1) by Computer, bin(TimeGenerated, ({TimeRange:end} - {TimeRange:start})/100)\r\n| render timechart\r\n",
                    "size": 0,
                    "aggregation": 3,
                    "showAnalytics": true,
                    "title": "NTDS\\ATQ Request Latency",
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "visualization": "timechart",
                    "chartSettings": {
                      "ySettings": {
                        "numberFormatSettings": {
                          "unit": 17,
                          "options": {
                            "style": "decimal",
                            "useGrouping": true,
                            "maximumFractionDigits": 2
                          }
                        }
                      }
                    }
                  },
                  "customWidth": "50",
                  "name": "QueryATQRequestLatency",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "//NTDS([\"\"])\\ATQ Request Latency\r\nlet trend = \r\nPerf \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"NTDS\" and CounterName == \"ATQ Request Latency\" \r\n| make-series Average = round(avg(CounterValue), 2) default = 0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step ({TimeRange:end} - {TimeRange:start})/100 by Computer     \r\n| project Computer, ['Trend'] = Average; \r\n\r\nPerf\r\n| where Computer in ({Computer})\r\n| where ObjectName == \"NTDS\" and CounterName == \"ATQ Request Latency\" \r\n| summarize Average=round(avg(CounterValue),2),StDev=round(stdevp(CounterValue),2), percentiles(CounterValue,50,75,95) by Computer\r\n| join (trend) on Computer\r\n| project Computer, [\"Avg.\"]=Average,StDev,p50=round(percentile_CounterValue_50,2),p75=round(percentile_CounterValue_75,2),p95=round(percentile_CounterValue_95,2), Trend\r\n| sort by [\"Avg.\"]",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "ATQ Request Latency",
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Computer",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "28ch"
                          }
                        },
                        {
                          "columnMatch": "Avg.",
                          "formatter": 8,
                          "formatOptions": {
                            "min": -10,
                            "max": 100,
                            "palette": "blue",
                            "customColumnWidthSetting": "12ch"
                          },
                          "numberFormat": {
                            "unit": 0,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "StDev",
                          "formatter": 8,
                          "formatOptions": {
                            "min": -10,
                            "max": 100,
                            "palette": "orange",
                            "customColumnWidthSetting": "11ch"
                          },
                          "numberFormat": {
                            "unit": 0,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "p50",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          }
                        },
                        {
                          "columnMatch": "p75",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          }
                        },
                        {
                          "columnMatch": "p95",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          }
                        },
                        {
                          "columnMatch": "Trend",
                          "formatter": 21,
                          "formatOptions": {
                            "min": 0,
                            "max": 100,
                            "palette": "green"
                          }
                        },
                        {
                          "columnMatch": "Status",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "Healthy",
                                "representation": "success",
                                "text": "{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Warning",
                                "representation": "2",
                                "text": "{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Critical",
                                "representation": "critical",
                                "text": "{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "unknown",
                                "text": "{1}"
                              }
                            ],
                            "customColumnWidthSetting": "11ch"
                          }
                        }
                      ]
                    },
                    "sortBy": []
                  },
                  "customWidth": "50",
                  "name": "TableATQRequestLatency",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "//NTDS([\"\"])\\ATQ Threads LDAP\r\nPerf \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"NTDS\" and CounterName == \"ATQ Threads LDAP\" \r\n| summarize Used_CPU = round(avg(CounterValue),1) by Computer, bin(TimeGenerated, ({TimeRange:end} - {TimeRange:start})/100)\r\n| render timechart\r\n",
                    "size": 0,
                    "aggregation": 3,
                    "showAnalytics": true,
                    "title": "NTDS\\ATQ Threads LDAP",
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "visualization": "timechart",
                    "chartSettings": {
                      "ySettings": {
                        "numberFormatSettings": {
                          "unit": 17,
                          "options": {
                            "style": "decimal",
                            "useGrouping": true,
                            "maximumFractionDigits": 2
                          }
                        }
                      }
                    }
                  },
                  "customWidth": "50",
                  "name": "QueryATQThreadsLDAP",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "//NTDS([\"\"])\\ATQ Threads LDAP\r\nlet trend = \r\nPerf \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"NTDS\" and CounterName == \"ATQ Threads LDAP\" \r\n| make-series Average = round(avg(CounterValue), 2) default = 0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step ({TimeRange:end} - {TimeRange:start})/100 by Computer     \r\n| project Computer, ['Trend'] = Average; \r\n\r\nPerf\r\n| where Computer in ({Computer})\r\n| where ObjectName == \"NTDS\" and CounterName == \"ATQ Threads LDAP\" \r\n| summarize Average=round(avg(CounterValue),2),StDev=round(stdevp(CounterValue),2), percentiles(CounterValue,50,75,95) by Computer\r\n| join (trend) on Computer\r\n| project Computer, [\"Avg.\"]=Average,StDev,p50=round(percentile_CounterValue_50,2),p75=round(percentile_CounterValue_75,2),p95=round(percentile_CounterValue_95,2), Trend\r\n| sort by [\"Avg.\"]",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "ATQ Threads LDAP",
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Computer",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "28ch"
                          }
                        },
                        {
                          "columnMatch": "Avg.",
                          "formatter": 8,
                          "formatOptions": {
                            "min": -10,
                            "max": 100,
                            "palette": "blue",
                            "customColumnWidthSetting": "12ch"
                          },
                          "numberFormat": {
                            "unit": 0,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "StDev",
                          "formatter": 8,
                          "formatOptions": {
                            "min": -10,
                            "max": 100,
                            "palette": "orange",
                            "customColumnWidthSetting": "11ch"
                          },
                          "numberFormat": {
                            "unit": 0,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "p50",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          }
                        },
                        {
                          "columnMatch": "p75",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          }
                        },
                        {
                          "columnMatch": "p95",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          }
                        },
                        {
                          "columnMatch": "Trend",
                          "formatter": 21,
                          "formatOptions": {
                            "min": 0,
                            "max": 100,
                            "palette": "green"
                          }
                        },
                        {
                          "columnMatch": "Status",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "Healthy",
                                "representation": "success",
                                "text": "{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Warning",
                                "representation": "2",
                                "text": "{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Critical",
                                "representation": "critical",
                                "text": "{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "unknown",
                                "text": "{1}"
                              }
                            ],
                            "customColumnWidthSetting": "11ch"
                          }
                        }
                      ]
                    },
                    "sortBy": []
                  },
                  "customWidth": "50",
                  "name": "TableATQThreadsLDAP",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "//NTDS([\"\"])\\ATQ Threads Other\r\nPerf \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"NTDS\" and CounterName == \"ATQ Threads Other\" \r\n| summarize Used_CPU = round(avg(CounterValue),1) by Computer, bin(TimeGenerated, ({TimeRange:end} - {TimeRange:start})/100)\r\n| render timechart\r\n",
                    "size": 0,
                    "aggregation": 3,
                    "showAnalytics": true,
                    "title": "NTDS\\ATQ Threads Other",
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "visualization": "timechart",
                    "chartSettings": {
                      "ySettings": {
                        "numberFormatSettings": {
                          "unit": 17,
                          "options": {
                            "style": "decimal",
                            "useGrouping": true,
                            "maximumFractionDigits": 2
                          }
                        }
                      }
                    }
                  },
                  "customWidth": "50",
                  "name": "QueryATQThreadsOther",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "//NTDS([\"\"])\\ATQ Threads Other\r\nlet trend = \r\nPerf \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"NTDS\" and CounterName == \"ATQ Threads Other\" \r\n| make-series Average = round(avg(CounterValue), 2) default = 0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step ({TimeRange:end} - {TimeRange:start})/100 by Computer     \r\n| project Computer, ['Trend'] = Average; \r\n\r\nPerf\r\n| where Computer in ({Computer})\r\n| where ObjectName == \"NTDS\" and CounterName == \"ATQ Threads Other\" \r\n| summarize Average=round(avg(CounterValue),2),StDev=round(stdevp(CounterValue),2), percentiles(CounterValue,50,75,95) by Computer\r\n| join (trend) on Computer\r\n| project Computer, [\"Avg.\"]=Average,StDev,p50=round(percentile_CounterValue_50,2),p75=round(percentile_CounterValue_75,2),p95=round(percentile_CounterValue_95,2), Trend\r\n| sort by [\"Avg.\"]",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "ATQ Threads Other",
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Computer",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "28ch"
                          }
                        },
                        {
                          "columnMatch": "Avg.",
                          "formatter": 8,
                          "formatOptions": {
                            "min": -10,
                            "max": 100,
                            "palette": "blue",
                            "customColumnWidthSetting": "12ch"
                          },
                          "numberFormat": {
                            "unit": 0,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "StDev",
                          "formatter": 8,
                          "formatOptions": {
                            "min": -10,
                            "max": 100,
                            "palette": "orange",
                            "customColumnWidthSetting": "11ch"
                          },
                          "numberFormat": {
                            "unit": 0,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "p50",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          }
                        },
                        {
                          "columnMatch": "p75",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          }
                        },
                        {
                          "columnMatch": "p95",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          }
                        },
                        {
                          "columnMatch": "Trend",
                          "formatter": 21,
                          "formatOptions": {
                            "min": 0,
                            "max": 100,
                            "palette": "green"
                          }
                        },
                        {
                          "columnMatch": "Status",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "Healthy",
                                "representation": "success",
                                "text": "{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Warning",
                                "representation": "2",
                                "text": "{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Critical",
                                "representation": "critical",
                                "text": "{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "unknown",
                                "text": "{1}"
                              }
                            ],
                            "customColumnWidthSetting": "11ch"
                          }
                        }
                      ]
                    },
                    "sortBy": []
                  },
                  "customWidth": "50",
                  "name": "TableATQThreadsOther",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "//NTDS([\"\"])\\ATQ Threads Total\r\nPerf \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"NTDS\" and CounterName == \"ATQ Threads Total\" \r\n| summarize Used_CPU = round(avg(CounterValue),1) by Computer, bin(TimeGenerated, ({TimeRange:end} - {TimeRange:start})/100)\r\n| render timechart\r\n",
                    "size": 0,
                    "aggregation": 3,
                    "showAnalytics": true,
                    "title": "NTDS\\ATQ Threads Total",
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "visualization": "timechart",
                    "chartSettings": {
                      "ySettings": {
                        "numberFormatSettings": {
                          "unit": 17,
                          "options": {
                            "style": "decimal",
                            "useGrouping": true,
                            "maximumFractionDigits": 2
                          }
                        }
                      }
                    }
                  },
                  "customWidth": "50",
                  "name": "QueryATQThreadsTotal",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "//NTDS([\"\"])\\ATQ Threads Total\r\nlet trend = \r\nPerf \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"NTDS\" and CounterName == \"ATQ Threads Total\" \r\n| make-series Average = round(avg(CounterValue), 2) default = 0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step ({TimeRange:end} - {TimeRange:start})/100 by Computer     \r\n| project Computer, ['Trend'] = Average; \r\n\r\nPerf\r\n| where Computer in ({Computer})\r\n| where ObjectName == \"NTDS\" and CounterName == \"ATQ Threads Total\" \r\n| summarize Average=round(avg(CounterValue),2),StDev=round(stdevp(CounterValue),2), percentiles(CounterValue,50,75,95) by Computer\r\n| join (trend) on Computer\r\n| project Computer, [\"Avg.\"]=Average,StDev,p50=round(percentile_CounterValue_50,2),p75=round(percentile_CounterValue_75,2),p95=round(percentile_CounterValue_95,2), Trend\r\n| sort by [\"Avg.\"]",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "ATQ Threads Total",
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Computer",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "28ch"
                          }
                        },
                        {
                          "columnMatch": "Avg.",
                          "formatter": 8,
                          "formatOptions": {
                            "min": -10,
                            "max": 100,
                            "palette": "blue",
                            "customColumnWidthSetting": "12ch"
                          },
                          "numberFormat": {
                            "unit": 0,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "StDev",
                          "formatter": 8,
                          "formatOptions": {
                            "min": -10,
                            "max": 100,
                            "palette": "orange",
                            "customColumnWidthSetting": "11ch"
                          },
                          "numberFormat": {
                            "unit": 0,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "p50",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          }
                        },
                        {
                          "columnMatch": "p75",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          }
                        },
                        {
                          "columnMatch": "p95",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          }
                        },
                        {
                          "columnMatch": "Trend",
                          "formatter": 21,
                          "formatOptions": {
                            "min": 0,
                            "max": 100,
                            "palette": "green"
                          }
                        },
                        {
                          "columnMatch": "Status",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "Healthy",
                                "representation": "success",
                                "text": "{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Warning",
                                "representation": "2",
                                "text": "{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Critical",
                                "representation": "critical",
                                "text": "{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "unknown",
                                "text": "{1}"
                              }
                            ],
                            "customColumnWidthSetting": "11ch"
                          }
                        }
                      ]
                    },
                    "sortBy": []
                  },
                  "customWidth": "50",
                  "name": "TableATQEstimatedQueueDelay",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "//NTDS([\"\"])\\LDAP Active Threads\r\nPerf \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"NTDS\" and CounterName == \"LDAP Active Threads\" \r\n| summarize Used_CPU = round(avg(CounterValue),1) by Computer, bin(TimeGenerated, ({TimeRange:end} - {TimeRange:start})/100)\r\n| render timechart\r\n",
                    "size": 0,
                    "aggregation": 3,
                    "showAnalytics": true,
                    "title": "NTDS\\LDAP Active Threads",
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "visualization": "timechart",
                    "chartSettings": {
                      "ySettings": {
                        "numberFormatSettings": {
                          "unit": 17,
                          "options": {
                            "style": "decimal",
                            "useGrouping": true,
                            "maximumFractionDigits": 2
                          }
                        }
                      }
                    }
                  },
                  "customWidth": "50",
                  "name": "QueryLDAPActiveThreads",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "//NTDS([\"\"])\\LDAP Active Threads\r\nlet trend = \r\nPerf \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"NTDS\" and CounterName == \"LDAP Active Threads\" \r\n| make-series Average = round(avg(CounterValue), 2) default = 0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step ({TimeRange:end} - {TimeRange:start})/100 by Computer     \r\n| project Computer, ['Trend'] = Average; \r\n\r\nPerf\r\n| where Computer in ({Computer})\r\n| where ObjectName == \"NTDS\" and CounterName == \"LDAP Active Threads\" \r\n| summarize Average=round(avg(CounterValue),2),StDev=round(stdevp(CounterValue),2), percentiles(CounterValue,50,75,95) by Computer\r\n| join (trend) on Computer\r\n| project Computer, [\"Avg.\"]=Average,StDev,p50=round(percentile_CounterValue_50,2),p75=round(percentile_CounterValue_75,2),p95=round(percentile_CounterValue_95,2), Trend\r\n| sort by [\"Avg.\"]",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "LDAP Active Threads",
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Computer",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "28ch"
                          }
                        },
                        {
                          "columnMatch": "Avg.",
                          "formatter": 8,
                          "formatOptions": {
                            "min": -10,
                            "max": 100,
                            "palette": "blue",
                            "customColumnWidthSetting": "12ch"
                          },
                          "numberFormat": {
                            "unit": 0,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "StDev",
                          "formatter": 8,
                          "formatOptions": {
                            "min": -10,
                            "max": 100,
                            "palette": "orange",
                            "customColumnWidthSetting": "11ch"
                          },
                          "numberFormat": {
                            "unit": 0,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "p50",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          }
                        },
                        {
                          "columnMatch": "p75",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          }
                        },
                        {
                          "columnMatch": "p95",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          }
                        },
                        {
                          "columnMatch": "Trend",
                          "formatter": 21,
                          "formatOptions": {
                            "min": 0,
                            "max": 100,
                            "palette": "green"
                          }
                        },
                        {
                          "columnMatch": "Status",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "Healthy",
                                "representation": "success",
                                "text": "{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Warning",
                                "representation": "2",
                                "text": "{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Critical",
                                "representation": "critical",
                                "text": "{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "unknown",
                                "text": "{1}"
                              }
                            ],
                            "customColumnWidthSetting": "11ch"
                          }
                        }
                      ]
                    },
                    "sortBy": []
                  },
                  "customWidth": "50",
                  "name": "TableLDAPActiveThreads",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "//NTDS([\"\"])\\LDAP Bind Time\r\nPerf \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"NTDS\" and CounterName == \"LDAP Bind Time\" \r\n| summarize Used_CPU = round(avg(CounterValue),1) by Computer, bin(TimeGenerated, ({TimeRange:end} - {TimeRange:start})/100)\r\n| render timechart\r\n",
                    "size": 0,
                    "aggregation": 3,
                    "showAnalytics": true,
                    "title": "NTDS\\LDAP Bind Time",
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "visualization": "timechart",
                    "chartSettings": {
                      "ySettings": {
                        "numberFormatSettings": {
                          "unit": 17,
                          "options": {
                            "style": "decimal",
                            "useGrouping": true,
                            "maximumFractionDigits": 2
                          }
                        }
                      }
                    }
                  },
                  "customWidth": "50",
                  "name": "QueryLDAPBindTime",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "//NTDS([\"\"])\\LDAP Bind Time\r\nlet trend = \r\nPerf \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"NTDS\" and CounterName == \"LDAP Bind Time\" \r\n| make-series Average = round(avg(CounterValue), 2) default = 0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step ({TimeRange:end} - {TimeRange:start})/100 by Computer     \r\n| project Computer, ['Trend'] = Average; \r\n\r\nPerf\r\n| where Computer in ({Computer})\r\n| where ObjectName == \"NTDS\" and CounterName == \"LDAP Bind Time\" \r\n| summarize Average=round(avg(CounterValue),2),StDev=round(stdevp(CounterValue),2), percentiles(CounterValue,50,75,95) by Computer\r\n| join (trend) on Computer\r\n| project Computer, [\"Avg.\"]=Average,StDev,p50=round(percentile_CounterValue_50,2),p75=round(percentile_CounterValue_75,2),p95=round(percentile_CounterValue_95,2), Trend\r\n| sort by [\"Avg.\"]",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "LDAP Bind Time",
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Computer",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "28ch"
                          }
                        },
                        {
                          "columnMatch": "Avg.",
                          "formatter": 8,
                          "formatOptions": {
                            "min": -10,
                            "max": 100,
                            "palette": "blue",
                            "customColumnWidthSetting": "12ch"
                          },
                          "numberFormat": {
                            "unit": 0,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "StDev",
                          "formatter": 8,
                          "formatOptions": {
                            "min": -10,
                            "max": 100,
                            "palette": "orange",
                            "customColumnWidthSetting": "11ch"
                          },
                          "numberFormat": {
                            "unit": 0,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "p50",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          }
                        },
                        {
                          "columnMatch": "p75",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          }
                        },
                        {
                          "columnMatch": "p95",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          }
                        },
                        {
                          "columnMatch": "Trend",
                          "formatter": 21,
                          "formatOptions": {
                            "min": 0,
                            "max": 100,
                            "palette": "green"
                          }
                        },
                        {
                          "columnMatch": "Status",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "Healthy",
                                "representation": "success",
                                "text": "{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Warning",
                                "representation": "2",
                                "text": "{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Critical",
                                "representation": "critical",
                                "text": "{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "unknown",
                                "text": "{1}"
                              }
                            ],
                            "customColumnWidthSetting": "11ch"
                          }
                        }
                      ]
                    },
                    "sortBy": []
                  },
                  "customWidth": "50",
                  "name": "TableLDAPBindTime",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "//NTDS([\"\"])\\ATQ Outstanding Queued Requests\r\nPerf \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"NTDS\" and CounterName == \"ATQ Outstanding Queued Requests\" \r\n| summarize Used_CPU = round(avg(CounterValue),1) by Computer, bin(TimeGenerated, ({TimeRange:end} - {TimeRange:start})/100)\r\n| render timechart\r\n",
                    "size": 0,
                    "aggregation": 3,
                    "showAnalytics": true,
                    "title": "NTDS\\LDAP Searches/sec",
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "visualization": "timechart",
                    "chartSettings": {
                      "ySettings": {
                        "numberFormatSettings": {
                          "unit": 17,
                          "options": {
                            "style": "decimal",
                            "useGrouping": true,
                            "maximumFractionDigits": 2
                          }
                        }
                      }
                    }
                  },
                  "customWidth": "50",
                  "name": "QueryLDAPSearchessec",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "//NTDS([\"\"])\\LDAP Searches/sec\r\nlet trend = \r\nPerf \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"NTDS\" and CounterName == \"LDAP Searches/sec\" \r\n| make-series Average = round(avg(CounterValue), 2) default = 0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step ({TimeRange:end} - {TimeRange:start})/100 by Computer     \r\n| project Computer, ['Trend'] = Average; \r\n\r\nPerf\r\n| where Computer in ({Computer})\r\n| where ObjectName == \"NTDS\" and CounterName == \"LDAP Searches/sec\" \r\n| summarize Average=round(avg(CounterValue),2),StDev=round(stdevp(CounterValue),2), percentiles(CounterValue,50,75,95) by Computer\r\n| join (trend) on Computer\r\n| project Computer, [\"Avg.\"]=Average,StDev,p50=round(percentile_CounterValue_50,2),p75=round(percentile_CounterValue_75,2),p95=round(percentile_CounterValue_95,2), Trend\r\n| sort by [\"Avg.\"]",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "LDAP Searches/sec",
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Computer",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "28ch"
                          }
                        },
                        {
                          "columnMatch": "Avg.",
                          "formatter": 8,
                          "formatOptions": {
                            "min": -10,
                            "max": 100,
                            "palette": "blue",
                            "customColumnWidthSetting": "12ch"
                          },
                          "numberFormat": {
                            "unit": 0,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "StDev",
                          "formatter": 8,
                          "formatOptions": {
                            "min": -10,
                            "max": 100,
                            "palette": "orange",
                            "customColumnWidthSetting": "11ch"
                          },
                          "numberFormat": {
                            "unit": 0,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "p50",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          }
                        },
                        {
                          "columnMatch": "p75",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          }
                        },
                        {
                          "columnMatch": "p95",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          }
                        },
                        {
                          "columnMatch": "Trend",
                          "formatter": 21,
                          "formatOptions": {
                            "min": 0,
                            "max": 100,
                            "palette": "green"
                          }
                        },
                        {
                          "columnMatch": "Status",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "Healthy",
                                "representation": "success",
                                "text": "{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Warning",
                                "representation": "2",
                                "text": "{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Critical",
                                "representation": "critical",
                                "text": "{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "unknown",
                                "text": "{1}"
                              }
                            ],
                            "customColumnWidthSetting": "11ch"
                          }
                        }
                      ]
                    },
                    "sortBy": []
                  },
                  "customWidth": "50",
                  "name": "TableLDAPSearchessec",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "//NTDS([\"\"])\\LDAP Successful Binds/sec\r\nPerf \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"NTDS\" and CounterName == \"LDAP Successful Binds/sec\" \r\n| summarize Used_CPU = round(avg(CounterValue),1) by Computer, bin(TimeGenerated, ({TimeRange:end} - {TimeRange:start})/100)\r\n| render timechart\r\n",
                    "size": 0,
                    "aggregation": 3,
                    "showAnalytics": true,
                    "title": "NTDS\\LDAP Successful Binds/sec",
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "visualization": "timechart",
                    "chartSettings": {
                      "ySettings": {
                        "numberFormatSettings": {
                          "unit": 17,
                          "options": {
                            "style": "decimal",
                            "useGrouping": true,
                            "maximumFractionDigits": 2
                          }
                        }
                      }
                    }
                  },
                  "customWidth": "50",
                  "name": "QueryLDAPSuccessfulBinds/sec",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "//NTDS([\"\"])\\LDAP Successful Binds/sec\r\nlet trend = \r\nPerf \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"NTDS\" and CounterName == \"LDAP Successful Binds/sec\" \r\n| make-series Average = round(avg(CounterValue), 2) default = 0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step ({TimeRange:end} - {TimeRange:start})/100 by Computer     \r\n| project Computer, ['Trend'] = Average; \r\n\r\nPerf\r\n| where Computer in ({Computer})\r\n| where ObjectName == \"NTDS\" and CounterName == \"LDAP Successful Binds/sec\" \r\n| summarize Average=round(avg(CounterValue),2),StDev=round(stdevp(CounterValue),2), percentiles(CounterValue,50,75,95) by Computer\r\n| join (trend) on Computer\r\n| project Computer, [\"Avg.\"]=Average,StDev,p50=round(percentile_CounterValue_50,2),p75=round(percentile_CounterValue_75,2),p95=round(percentile_CounterValue_95,2), Trend\r\n| sort by [\"Avg.\"]",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "LDAP Successful Binds/sec",
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Computer",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "28ch"
                          }
                        },
                        {
                          "columnMatch": "Avg.",
                          "formatter": 8,
                          "formatOptions": {
                            "min": -10,
                            "max": 100,
                            "palette": "blue",
                            "customColumnWidthSetting": "12ch"
                          },
                          "numberFormat": {
                            "unit": 0,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "StDev",
                          "formatter": 8,
                          "formatOptions": {
                            "min": -10,
                            "max": 100,
                            "palette": "orange",
                            "customColumnWidthSetting": "11ch"
                          },
                          "numberFormat": {
                            "unit": 0,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "p50",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          }
                        },
                        {
                          "columnMatch": "p75",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          }
                        },
                        {
                          "columnMatch": "p95",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          }
                        },
                        {
                          "columnMatch": "Trend",
                          "formatter": 21,
                          "formatOptions": {
                            "min": 0,
                            "max": 100,
                            "palette": "green"
                          }
                        },
                        {
                          "columnMatch": "Status",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "Healthy",
                                "representation": "success",
                                "text": "{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Warning",
                                "representation": "2",
                                "text": "{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Critical",
                                "representation": "critical",
                                "text": "{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "unknown",
                                "text": "{1}"
                              }
                            ],
                            "customColumnWidthSetting": "11ch"
                          }
                        }
                      ]
                    },
                    "sortBy": []
                  },
                  "customWidth": "50",
                  "name": "TableLDAPSuccessfulBindssec",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "//NTDS([\"\"])\\LDAP Writes/sec\r\nPerf \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"NTDS\" and CounterName == \"LDAP Writes/sec\" \r\n| summarize Used_CPU = round(avg(CounterValue),1) by Computer, bin(TimeGenerated, ({TimeRange:end} - {TimeRange:start})/100)\r\n| render timechart\r\n",
                    "size": 0,
                    "aggregation": 3,
                    "showAnalytics": true,
                    "title": "NTDS\\LDAP Writes/sec",
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "visualization": "timechart",
                    "chartSettings": {
                      "ySettings": {
                        "numberFormatSettings": {
                          "unit": 17,
                          "options": {
                            "style": "decimal",
                            "useGrouping": true,
                            "maximumFractionDigits": 2
                          }
                        }
                      }
                    }
                  },
                  "customWidth": "50",
                  "name": "QueryLDAPWritessec",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "//NTDS([\"\"])\\LDAP Writes/sec\r\nlet trend = \r\nPerf \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"NTDS\" and CounterName == \"LDAP Writes/sec\" \r\n| make-series Average = round(avg(CounterValue), 2) default = 0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step ({TimeRange:end} - {TimeRange:start})/100 by Computer     \r\n| project Computer, ['Trend'] = Average; \r\n\r\nPerf\r\n| where Computer in ({Computer})\r\n| where ObjectName == \"NTDS\" and CounterName == \"LDAP Writes/sec\" \r\n| summarize Average=round(avg(CounterValue),2),StDev=round(stdevp(CounterValue),2), percentiles(CounterValue,50,75,95) by Computer\r\n| join (trend) on Computer\r\n| project Computer, [\"Avg.\"]=Average,StDev,p50=round(percentile_CounterValue_50,2),p75=round(percentile_CounterValue_75,2),p95=round(percentile_CounterValue_95,2), Trend\r\n| sort by [\"Avg.\"]",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "LDAP Writes/sec",
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Computer",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "28ch"
                          }
                        },
                        {
                          "columnMatch": "Avg.",
                          "formatter": 8,
                          "formatOptions": {
                            "min": -10,
                            "max": 100,
                            "palette": "blue",
                            "customColumnWidthSetting": "12ch"
                          },
                          "numberFormat": {
                            "unit": 0,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "StDev",
                          "formatter": 8,
                          "formatOptions": {
                            "min": -10,
                            "max": 100,
                            "palette": "orange",
                            "customColumnWidthSetting": "11ch"
                          },
                          "numberFormat": {
                            "unit": 0,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "p50",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          }
                        },
                        {
                          "columnMatch": "p75",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          }
                        },
                        {
                          "columnMatch": "p95",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          }
                        },
                        {
                          "columnMatch": "Trend",
                          "formatter": 21,
                          "formatOptions": {
                            "min": 0,
                            "max": 100,
                            "palette": "green"
                          }
                        },
                        {
                          "columnMatch": "Status",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "Healthy",
                                "representation": "success",
                                "text": "{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Warning",
                                "representation": "2",
                                "text": "{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Critical",
                                "representation": "critical",
                                "text": "{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "unknown",
                                "text": "{1}"
                              }
                            ],
                            "customColumnWidthSetting": "11ch"
                          }
                        }
                      ]
                    },
                    "sortBy": []
                  },
                  "customWidth": "50",
                  "name": "TableLDAPWritessec",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "//NTDS([\"\"])\\NTLM Binds/sec\r\nPerf \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"NTDS\" and CounterName == \"NTLM Binds/sec\" \r\n| summarize Used_CPU = round(avg(CounterValue),1) by Computer, bin(TimeGenerated, ({TimeRange:end} - {TimeRange:start})/100)\r\n| render timechart\r\n",
                    "size": 0,
                    "aggregation": 3,
                    "showAnalytics": true,
                    "title": "NTDS\\NTLM Binds/sec",
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "visualization": "timechart",
                    "chartSettings": {
                      "ySettings": {
                        "numberFormatSettings": {
                          "unit": 17,
                          "options": {
                            "style": "decimal",
                            "useGrouping": true,
                            "maximumFractionDigits": 2
                          }
                        }
                      }
                    }
                  },
                  "customWidth": "50",
                  "name": "QueryNTLMBindssec",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "//NTDS([\"\"])\\NTLM Binds/sec\r\nlet trend = \r\nPerf \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"NTDS\" and CounterName == \"NTLM Binds/sec\" \r\n| make-series Average = round(avg(CounterValue), 2) default = 0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step ({TimeRange:end} - {TimeRange:start})/100 by Computer     \r\n| project Computer, ['Trend'] = Average; \r\n\r\nPerf\r\n| where Computer in ({Computer})\r\n| where ObjectName == \"NTDS\" and CounterName == \"NTLM Binds/sec\" \r\n| summarize Average=round(avg(CounterValue),2),StDev=round(stdevp(CounterValue),2), percentiles(CounterValue,50,75,95) by Computer\r\n| join (trend) on Computer\r\n| project Computer, [\"Avg.\"]=Average,StDev,p50=round(percentile_CounterValue_50,2),p75=round(percentile_CounterValue_75,2),p95=round(percentile_CounterValue_95,2), Trend\r\n| sort by [\"Avg.\"]",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "NTLM Binds/sec",
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Computer",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "28ch"
                          }
                        },
                        {
                          "columnMatch": "Avg.",
                          "formatter": 8,
                          "formatOptions": {
                            "min": -10,
                            "max": 100,
                            "palette": "blue",
                            "customColumnWidthSetting": "12ch"
                          },
                          "numberFormat": {
                            "unit": 0,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "StDev",
                          "formatter": 8,
                          "formatOptions": {
                            "min": -10,
                            "max": 100,
                            "palette": "orange",
                            "customColumnWidthSetting": "11ch"
                          },
                          "numberFormat": {
                            "unit": 0,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "p50",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          }
                        },
                        {
                          "columnMatch": "p75",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          }
                        },
                        {
                          "columnMatch": "p95",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          }
                        },
                        {
                          "columnMatch": "Trend",
                          "formatter": 21,
                          "formatOptions": {
                            "min": 0,
                            "max": 100,
                            "palette": "green"
                          }
                        },
                        {
                          "columnMatch": "Status",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "Healthy",
                                "representation": "success",
                                "text": "{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Warning",
                                "representation": "2",
                                "text": "{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Critical",
                                "representation": "critical",
                                "text": "{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "unknown",
                                "text": "{1}"
                              }
                            ],
                            "customColumnWidthSetting": "11ch"
                          }
                        }
                      ]
                    },
                    "sortBy": []
                  },
                  "customWidth": "50",
                  "name": "TableNTLMBindssec",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "nav",
                    "links": [
                      {
                        "id": "3142de97-0271-4c36-9e7b-eb61a3f6eb79",
                        "cellValue": "TableATQEstimatedQueueDelay",
                        "linkTarget": "step",
                        "linkLabel": "Go back",
                        "style": "secondary"
                      }
                    ]
                  },
                  "customWidth": "90",
                  "name": "links - 18"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "selectedTab",
              "comparison": "isEqualTo",
              "value": "NTDS"
            },
            "name": "NTDSGroup"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "DFSRSGroup",
              "items": [
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "//Process([\"dfsrs\"])\\% Processor Time\r\nPerf \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"Process\" and CounterName == \"% Processor Time\" and InstanceName==\"dfsrs\"\r\n| summarize Used_CPU = round(avg(CounterValue),1) by Computer, bin(TimeGenerated, ({TimeRange:end} - {TimeRange:start})/100)\r\n| render timechart\r\n",
                    "size": 0,
                    "aggregation": 3,
                    "showAnalytics": true,
                    "title": "Process([\"dfsrs\"])\\% Processor Time",
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "visualization": "timechart",
                    "chartSettings": {
                      "ySettings": {
                        "numberFormatSettings": {
                          "unit": 1,
                          "options": {
                            "style": "decimal",
                            "useGrouping": true,
                            "maximumFractionDigits": 2
                          }
                        }
                      }
                    }
                  },
                  "customWidth": "50",
                  "name": "QueryPCTProcessorTimedfsrs",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "//Process([\"dfsrs\"])\\% Processor Time\r\nlet trend = \r\nPerf \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"Process\" and CounterName == \"% Processor Time\" and InstanceName==\"dfsrs\"\r\n| make-series Average = round(avg(CounterValue), 2) default = 0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step ({TimeRange:end} - {TimeRange:start})/100 by Computer     \r\n| project Computer, ['Trend'] = Average; \r\n\r\nPerf\r\n| where Computer in ({Computer})\r\n| where ObjectName == \"Process\" and CounterName == \"% Processor Time\" and InstanceName==\"dfsrs\"\r\n| summarize Average=round(avg(CounterValue),2),StDev=round(stdevp(CounterValue),2), percentiles(CounterValue,50,75,95) by Computer\r\n| join (trend) on Computer\r\n| extend Status = case (\r\n                  Average > 50, \"Critical\",\r\n                  Average >= 20, \"Warning\",\r\n                  Average < 20, \"Healthy\",\r\n                  \"Unknown\")\r\n| project Status,Computer, [\"Avg.\"]=Average,StDev,p50=round(percentile_CounterValue_50,2),p75=round(percentile_CounterValue_75,2),p95=round(percentile_CounterValue_95,2), Trend\r\n| sort by [\"Avg.\"]",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "% Processor Time",
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Status",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "Healthy",
                                "representation": "success",
                                "text": "{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Warning",
                                "representation": "2",
                                "text": "{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Critical",
                                "representation": "critical",
                                "text": "{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "unknown",
                                "text": "{1}"
                              }
                            ],
                            "customColumnWidthSetting": "11ch"
                          }
                        },
                        {
                          "columnMatch": "Computer",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "28ch"
                          }
                        },
                        {
                          "columnMatch": "Avg.",
                          "formatter": 8,
                          "formatOptions": {
                            "min": -10,
                            "max": 100,
                            "palette": "blue",
                            "customColumnWidthSetting": "12ch"
                          },
                          "numberFormat": {
                            "unit": 1,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "StDev",
                          "formatter": 8,
                          "formatOptions": {
                            "min": -10,
                            "max": 100,
                            "palette": "orange",
                            "customColumnWidthSetting": "11ch"
                          },
                          "numberFormat": {
                            "unit": 1,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "p50",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          },
                          "numberFormat": {
                            "unit": 1,
                            "options": {
                              "style": "decimal"
                            }
                          }
                        },
                        {
                          "columnMatch": "p75",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          },
                          "numberFormat": {
                            "unit": 1,
                            "options": {
                              "style": "decimal"
                            }
                          }
                        },
                        {
                          "columnMatch": "p95",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          },
                          "numberFormat": {
                            "unit": 1,
                            "options": {
                              "style": "decimal"
                            }
                          }
                        },
                        {
                          "columnMatch": "Trend",
                          "formatter": 21,
                          "formatOptions": {
                            "min": 0,
                            "max": 100,
                            "palette": "green"
                          }
                        }
                      ]
                    },
                    "sortBy": []
                  },
                  "customWidth": "50",
                  "name": "TablePCTProcessorTimedfsrs",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "//Process([\"dfsrs\"])\\Handle Count\r\nPerf \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"Process\" and CounterName == \"Handle Count\" and InstanceName==\"dfsrs\"\r\n| summarize Used_CPU = round(avg(CounterValue),1) by Computer, bin(TimeGenerated, ({TimeRange:end} - {TimeRange:start})/100)\r\n| render timechart\r\n",
                    "size": 0,
                    "aggregation": 3,
                    "showAnalytics": true,
                    "title": "Process([\"dfsrs\"])\\Handle Count",
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "visualization": "timechart",
                    "chartSettings": {
                      "ySettings": {
                        "numberFormatSettings": {
                          "unit": 17,
                          "options": {
                            "style": "decimal",
                            "useGrouping": true,
                            "maximumFractionDigits": 2
                          }
                        }
                      }
                    }
                  },
                  "customWidth": "50",
                  "name": "QueryHandleCountdfsrs",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "//Process([\"dfsrs\"])\\Handle Count\r\nlet trend = \r\nPerf \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"Process\" and CounterName == \"Handle Count\" and InstanceName==\"dfsrs\"\r\n| make-series Average = round(avg(CounterValue), 2) default = 0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step ({TimeRange:end} - {TimeRange:start})/100 by Computer     \r\n| project Computer, ['Trend'] = Average; \r\n\r\nPerf\r\n| where Computer in ({Computer})\r\n| where ObjectName == \"Process\" and CounterName == \"Handle Count\" and InstanceName==\"dfsrs\"\r\n| summarize Average=round(avg(CounterValue),2),StDev=round(stdevp(CounterValue),2), percentiles(CounterValue,50,75,95) by Computer\r\n| join (trend) on Computer\r\n| extend Status = case (\r\n                  Average > 30000, \"Critical\",\r\n                  Average >= 20000, \"Warning\",\r\n                  Average < 20000, \"Healthy\",\r\n                  \"Unknown\")\r\n| project Status,Computer, [\"Avg.\"]=Average,StDev,p50=round(percentile_CounterValue_50,2),p75=round(percentile_CounterValue_75,2),p95=round(percentile_CounterValue_95,2), Trend\r\n| sort by [\"Avg.\"]",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Handle Count",
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Status",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "Healthy",
                                "representation": "success",
                                "text": "{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Warning",
                                "representation": "2",
                                "text": "{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Critical",
                                "representation": "critical",
                                "text": "{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "unknown",
                                "text": "{1}"
                              }
                            ],
                            "customColumnWidthSetting": "11ch"
                          }
                        },
                        {
                          "columnMatch": "Computer",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "28ch"
                          }
                        },
                        {
                          "columnMatch": "Avg.",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "blue",
                            "customColumnWidthSetting": "12ch"
                          },
                          "numberFormat": {
                            "unit": 17,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "StDev",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "orange",
                            "customColumnWidthSetting": "11ch"
                          },
                          "numberFormat": {
                            "unit": 17,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "p50",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          },
                          "numberFormat": {
                            "unit": 17,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "p75",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          },
                          "numberFormat": {
                            "unit": 17,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "p95",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          },
                          "numberFormat": {
                            "unit": 17,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "Trend",
                          "formatter": 21,
                          "formatOptions": {
                            "min": 0,
                            "max": 100,
                            "palette": "green"
                          }
                        }
                      ]
                    },
                    "sortBy": []
                  },
                  "customWidth": "50",
                  "name": "TableHandleCountdfsrs - Copy",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "//Process([\"dfsrs\"])\\Private Bytes\r\nPerf \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"Process\" and CounterName == \"Private Bytes\" and InstanceName==\"dfsrs\"\r\n| summarize Used_CPU = round(avg(CounterValue),1) by Computer, bin(TimeGenerated, ({TimeRange:end} - {TimeRange:start})/100)\r\n| render timechart\r\n",
                    "size": 0,
                    "aggregation": 3,
                    "showAnalytics": true,
                    "title": "Process([\"dfsrs\"])\\Private Bytes",
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "visualization": "timechart",
                    "chartSettings": {
                      "ySettings": {
                        "numberFormatSettings": {
                          "unit": 2,
                          "options": {
                            "style": "decimal",
                            "useGrouping": true,
                            "maximumFractionDigits": 2
                          }
                        }
                      }
                    }
                  },
                  "customWidth": "50",
                  "name": "QueryPrivateBytesdfsrs",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "//Process([\"dfsrs\"])\\Private Bytes\r\nlet trend = \r\nPerf \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"Process\" and CounterName == \"Private Bytes\" and InstanceName==\"dfsrs\"\r\n| make-series Average = round(avg(CounterValue), 2) default = 0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step ({TimeRange:end} - {TimeRange:start})/100 by Computer     \r\n| project Computer, ['Trend'] = Average; \r\n\r\nPerf\r\n| where Computer in ({Computer})\r\n| where ObjectName == \"Process\" and CounterName == \"Private Bytes\" and InstanceName==\"dfsrs\"\r\n| summarize Average=round(avg(CounterValue),2),StDev=round(stdevp(CounterValue),2), percentiles(CounterValue,50,75,95) by Computer\r\n| join (trend) on Computer\r\n| extend Status = case (\r\n                  Average > 1610612736, \"Critical\", //1.6GB\r\n                  Average >= 1073741824, \"Warning\", //1GB\r\n                  Average < 1073741824, \"Healthy\",\r\n                  \"Unknown\")\r\n| project Status,Computer, [\"Avg.\"]=Average,StDev,p50=round(percentile_CounterValue_50,2),p75=round(percentile_CounterValue_75,2),p95=round(percentile_CounterValue_95,2), Trend\r\n| sort by [\"Avg.\"]",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Private Bytes",
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Status",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "Healthy",
                                "representation": "success",
                                "text": "{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Warning",
                                "representation": "2",
                                "text": "{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Critical",
                                "representation": "critical",
                                "text": "{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "unknown",
                                "text": "{1}"
                              }
                            ],
                            "customColumnWidthSetting": "11ch"
                          }
                        },
                        {
                          "columnMatch": "Computer",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "28ch"
                          }
                        },
                        {
                          "columnMatch": "Avg.",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "blue",
                            "customColumnWidthSetting": "12ch"
                          },
                          "numberFormat": {
                            "unit": 2,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "StDev",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "orange",
                            "customColumnWidthSetting": "11ch"
                          },
                          "numberFormat": {
                            "unit": 2,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "p50",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "10ch"
                          },
                          "numberFormat": {
                            "unit": 2,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "p75",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "10ch"
                          },
                          "numberFormat": {
                            "unit": 2,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "p95",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "10ch"
                          },
                          "numberFormat": {
                            "unit": 2,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "Trend",
                          "formatter": 21,
                          "formatOptions": {
                            "min": 0,
                            "max": 100,
                            "palette": "green"
                          }
                        }
                      ]
                    },
                    "sortBy": []
                  },
                  "customWidth": "50",
                  "name": "TablePrivateBytesdfsrs",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "//Process([\"dfsrs\"])\\Working Set\r\nPerf \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"Process\" and CounterName == \"Working Set\" and InstanceName==\"dfsrs\"\r\n| summarize Used_CPU = round(avg(CounterValue),1) by Computer, bin(TimeGenerated, ({TimeRange:end} - {TimeRange:start})/100)\r\n| render timechart\r\n",
                    "size": 0,
                    "aggregation": 3,
                    "showAnalytics": true,
                    "title": "Process([\"dfsrs\"])\\Working Set",
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "visualization": "timechart",
                    "chartSettings": {
                      "ySettings": {
                        "numberFormatSettings": {
                          "unit": 2,
                          "options": {
                            "style": "decimal",
                            "useGrouping": true,
                            "maximumFractionDigits": 2
                          }
                        }
                      }
                    }
                  },
                  "customWidth": "50",
                  "name": "QueryWorkingSetdfsrs",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "//Process([\"dfsrs\"])\\Working Set\r\nlet trend = \r\nPerf \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"Process\" and CounterName == \"Working Set\" and InstanceName==\"dfsrs\"\r\n| make-series Average = round(avg(CounterValue), 2) default = 0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step ({TimeRange:end} - {TimeRange:start})/100 by Computer     \r\n| project Computer, ['Trend'] = Average; \r\n\r\nPerf\r\n| where Computer in ({Computer})\r\n| where ObjectName == \"Process\" and CounterName == \"Working Set\" and InstanceName==\"dfsrs\"\r\n| summarize Average=round(avg(CounterValue),2),StDev=round(stdevp(CounterValue),2), percentiles(CounterValue,50,75,95) by Computer\r\n| join (trend) on Computer\r\n//| extend Status = case (\r\n//                  Average > 1610612736, \"Critical\", //1.6GB\r\n//                  Average >= 1073741824, \"Warning\", //1GB\r\n//                  Average < 1073741824, \"Healthy\",\r\n//                  \"Unknown\")\r\n| project Computer, [\"Avg.\"]=Average,StDev,p50=round(percentile_CounterValue_50,2),p75=round(percentile_CounterValue_75,2),p95=round(percentile_CounterValue_95,2), Trend\r\n| sort by [\"Avg.\"]",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Working Set",
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Status",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "Healthy",
                                "representation": "success",
                                "text": "{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Warning",
                                "representation": "2",
                                "text": "{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Critical",
                                "representation": "critical",
                                "text": "{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "unknown",
                                "text": "{1}"
                              }
                            ],
                            "customColumnWidthSetting": "11ch"
                          }
                        },
                        {
                          "columnMatch": "Computer",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "28ch"
                          }
                        },
                        {
                          "columnMatch": "Avg.",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "blue",
                            "customColumnWidthSetting": "12ch"
                          },
                          "numberFormat": {
                            "unit": 2,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "StDev",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "orange",
                            "customColumnWidthSetting": "11ch"
                          },
                          "numberFormat": {
                            "unit": 2,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "p50",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "10ch"
                          },
                          "numberFormat": {
                            "unit": 2,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "p75",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "10ch"
                          },
                          "numberFormat": {
                            "unit": 2,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "p95",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "10ch"
                          },
                          "numberFormat": {
                            "unit": 2,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "Trend",
                          "formatter": 21,
                          "formatOptions": {
                            "min": 0,
                            "max": 100,
                            "palette": "green"
                          }
                        }
                      ]
                    },
                    "sortBy": []
                  },
                  "customWidth": "50",
                  "name": "TableWorkingSetdfsrs",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "nav",
                    "links": [
                      {
                        "id": "3142de97-0271-4c36-9e7b-eb61a3f6eb79",
                        "cellValue": "TablePCTProcessorTimedfsrs",
                        "linkTarget": "step",
                        "linkLabel": "Go back",
                        "style": "secondary"
                      }
                    ]
                  },
                  "customWidth": "90",
                  "name": "links - 18"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "selectedTab",
              "comparison": "isEqualTo",
              "value": "DFSRS"
            },
            "name": "DFSRSGroup"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "DNSGroup",
              "items": [
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "//Process([\"dns\"])\\% Processor Time\r\nPerf \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"Process\" and CounterName == \"% Processor Time\" and InstanceName==\"dns\"\r\n| summarize Used_CPU = round(avg(CounterValue),1) by Computer, bin(TimeGenerated, ({TimeRange:end} - {TimeRange:start})/100)\r\n| render timechart\r\n",
                    "size": 0,
                    "aggregation": 3,
                    "showAnalytics": true,
                    "title": "Process([\"dns\"])\\% Processor Time",
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "visualization": "timechart",
                    "chartSettings": {
                      "ySettings": {
                        "numberFormatSettings": {
                          "unit": 1,
                          "options": {
                            "style": "decimal",
                            "useGrouping": true,
                            "maximumFractionDigits": 2
                          }
                        }
                      }
                    }
                  },
                  "customWidth": "50",
                  "name": "QueryPCTProcessorTimedns",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "//Process([\"dns\"])\\% Processor Time\r\nlet trend = \r\nPerf \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"Process\" and CounterName == \"% Processor Time\" and InstanceName==\"dns\"\r\n| make-series Average = round(avg(CounterValue), 2) default = 0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step ({TimeRange:end} - {TimeRange:start})/100 by Computer     \r\n| project Computer, ['Trend'] = Average; \r\n\r\nPerf\r\n| where Computer in ({Computer})\r\n| where ObjectName == \"Process\" and CounterName == \"% Processor Time\" and InstanceName==\"dns\"\r\n| summarize Average=round(avg(CounterValue),2),StDev=round(stdevp(CounterValue),2), percentiles(CounterValue,50,75,95) by Computer\r\n| join (trend) on Computer\r\n| extend Status = case (\r\n                  Average > 50, \"Critical\",\r\n                  Average >= 20, \"Warning\",\r\n                  Average < 20, \"Healthy\",\r\n                  \"Unknown\")\r\n| project Status,Computer, [\"Avg.\"]=Average,StDev,p50=round(percentile_CounterValue_50,2),p75=round(percentile_CounterValue_75,2),p95=round(percentile_CounterValue_95,2), Trend\r\n| sort by [\"Avg.\"]",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "% Processor Time",
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Status",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "Healthy",
                                "representation": "success",
                                "text": "{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Warning",
                                "representation": "2",
                                "text": "{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Critical",
                                "representation": "critical",
                                "text": "{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "unknown",
                                "text": "{1}"
                              }
                            ],
                            "customColumnWidthSetting": "11ch"
                          }
                        },
                        {
                          "columnMatch": "Computer",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "28ch"
                          }
                        },
                        {
                          "columnMatch": "Avg.",
                          "formatter": 8,
                          "formatOptions": {
                            "min": -10,
                            "max": 100,
                            "palette": "blue",
                            "customColumnWidthSetting": "12ch"
                          },
                          "numberFormat": {
                            "unit": 1,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "StDev",
                          "formatter": 8,
                          "formatOptions": {
                            "min": -10,
                            "max": 100,
                            "palette": "orange",
                            "customColumnWidthSetting": "11ch"
                          },
                          "numberFormat": {
                            "unit": 1,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "p50",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          },
                          "numberFormat": {
                            "unit": 1,
                            "options": {
                              "style": "decimal"
                            }
                          }
                        },
                        {
                          "columnMatch": "p75",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          },
                          "numberFormat": {
                            "unit": 1,
                            "options": {
                              "style": "decimal"
                            }
                          }
                        },
                        {
                          "columnMatch": "p95",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          },
                          "numberFormat": {
                            "unit": 1,
                            "options": {
                              "style": "decimal"
                            }
                          }
                        },
                        {
                          "columnMatch": "Trend",
                          "formatter": 21,
                          "formatOptions": {
                            "min": 0,
                            "max": 100,
                            "palette": "green"
                          }
                        }
                      ]
                    },
                    "sortBy": []
                  },
                  "customWidth": "50",
                  "name": "TablePCTProcessorTimedns",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "//Process([\"dns\"])\\Handle Count\r\nPerf \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"Process\" and CounterName == \"Handle Count\" and InstanceName==\"dns\"\r\n| summarize Used_CPU = round(avg(CounterValue),1) by Computer, bin(TimeGenerated, ({TimeRange:end} - {TimeRange:start})/100)\r\n| render timechart\r\n",
                    "size": 0,
                    "aggregation": 3,
                    "showAnalytics": true,
                    "title": "Process([\"dns\"])\\Handle Count",
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "visualization": "timechart",
                    "chartSettings": {
                      "ySettings": {
                        "numberFormatSettings": {
                          "unit": 17,
                          "options": {
                            "style": "decimal",
                            "useGrouping": true,
                            "maximumFractionDigits": 2
                          }
                        }
                      }
                    }
                  },
                  "customWidth": "50",
                  "name": "QueryHandleCountdns",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "//Process([\"dns\"])\\Handle Count\r\nlet trend = \r\nPerf \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"Process\" and CounterName == \"Handle Count\" and InstanceName==\"dns\"\r\n| make-series Average = round(avg(CounterValue), 2) default = 0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step ({TimeRange:end} - {TimeRange:start})/100 by Computer     \r\n| project Computer, ['Trend'] = Average; \r\n\r\nPerf\r\n| where Computer in ({Computer})\r\n| where ObjectName == \"Process\" and CounterName == \"Handle Count\" and InstanceName==\"dns\"\r\n| summarize Average=round(avg(CounterValue),2),StDev=round(stdevp(CounterValue),2), percentiles(CounterValue,50,75,95) by Computer\r\n| join (trend) on Computer\r\n| extend Status = case (\r\n                  Average > 30000, \"Critical\",\r\n                  Average >= 20000, \"Warning\",\r\n                  Average < 20000, \"Healthy\",\r\n                  \"Unknown\")\r\n| project Status,Computer, [\"Avg.\"]=Average,StDev,p50=round(percentile_CounterValue_50,2),p75=round(percentile_CounterValue_75,2),p95=round(percentile_CounterValue_95,2), Trend\r\n| sort by [\"Avg.\"]",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Handle Count",
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Status",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "Healthy",
                                "representation": "success",
                                "text": "{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Warning",
                                "representation": "2",
                                "text": "{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Critical",
                                "representation": "critical",
                                "text": "{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "unknown",
                                "text": "{1}"
                              }
                            ],
                            "customColumnWidthSetting": "11ch"
                          }
                        },
                        {
                          "columnMatch": "Computer",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "28ch"
                          }
                        },
                        {
                          "columnMatch": "Avg.",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "blue",
                            "customColumnWidthSetting": "12ch"
                          },
                          "numberFormat": {
                            "unit": 17,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "StDev",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "orange",
                            "customColumnWidthSetting": "11ch"
                          },
                          "numberFormat": {
                            "unit": 17,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "p50",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          },
                          "numberFormat": {
                            "unit": 17,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "p75",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          },
                          "numberFormat": {
                            "unit": 17,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "p95",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          },
                          "numberFormat": {
                            "unit": 17,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "Trend",
                          "formatter": 21,
                          "formatOptions": {
                            "min": 0,
                            "max": 100,
                            "palette": "green"
                          }
                        }
                      ]
                    },
                    "sortBy": []
                  },
                  "customWidth": "50",
                  "name": "TableHandleCountdns - Copy",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "//Process([\"dns\"])\\Private Bytes\r\nPerf \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"Process\" and CounterName == \"Private Bytes\" and InstanceName==\"dns\"\r\n| summarize Used_CPU = round(avg(CounterValue),1) by Computer, bin(TimeGenerated, ({TimeRange:end} - {TimeRange:start})/100)\r\n| render timechart\r\n",
                    "size": 0,
                    "aggregation": 3,
                    "showAnalytics": true,
                    "title": "Process([\"dns\"])\\Private Bytes",
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "visualization": "timechart",
                    "chartSettings": {
                      "ySettings": {
                        "numberFormatSettings": {
                          "unit": 2,
                          "options": {
                            "style": "decimal",
                            "useGrouping": true,
                            "maximumFractionDigits": 2
                          }
                        }
                      }
                    }
                  },
                  "customWidth": "50",
                  "name": "QueryPrivateBytesdns",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "//Process([\"dns\"])\\Private Bytes\r\nlet trend = \r\nPerf \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"Process\" and CounterName == \"Private Bytes\" and InstanceName==\"dns\"\r\n| make-series Average = round(avg(CounterValue), 2) default = 0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step ({TimeRange:end} - {TimeRange:start})/100 by Computer     \r\n| project Computer, ['Trend'] = Average; \r\n\r\nPerf\r\n| where Computer in ({Computer})\r\n| where ObjectName == \"Process\" and CounterName == \"Private Bytes\" and InstanceName==\"dns\"\r\n| summarize Average=round(avg(CounterValue),2),StDev=round(stdevp(CounterValue),2), percentiles(CounterValue,50,75,95) by Computer\r\n| join (trend) on Computer\r\n| extend Status = case (\r\n                  Average > 1610612736, \"Critical\", //1.6GB\r\n                  Average >= 1073741824, \"Warning\", //1GB\r\n                  Average < 1073741824, \"Healthy\",\r\n                  \"Unknown\")\r\n| project Status,Computer, [\"Avg.\"]=Average,StDev,p50=round(percentile_CounterValue_50,2),p75=round(percentile_CounterValue_75,2),p95=round(percentile_CounterValue_95,2), Trend\r\n| sort by [\"Avg.\"]",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Private Bytes",
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Status",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "Healthy",
                                "representation": "success",
                                "text": "{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Warning",
                                "representation": "2",
                                "text": "{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Critical",
                                "representation": "critical",
                                "text": "{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "unknown",
                                "text": "{1}"
                              }
                            ],
                            "customColumnWidthSetting": "11ch"
                          }
                        },
                        {
                          "columnMatch": "Computer",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "28ch"
                          }
                        },
                        {
                          "columnMatch": "Avg.",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "blue",
                            "customColumnWidthSetting": "12ch"
                          },
                          "numberFormat": {
                            "unit": 2,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "StDev",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "orange",
                            "customColumnWidthSetting": "11ch"
                          },
                          "numberFormat": {
                            "unit": 2,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "p50",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "10ch"
                          },
                          "numberFormat": {
                            "unit": 2,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "p75",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "10ch"
                          },
                          "numberFormat": {
                            "unit": 2,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "p95",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "10ch"
                          },
                          "numberFormat": {
                            "unit": 2,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "Trend",
                          "formatter": 21,
                          "formatOptions": {
                            "min": 0,
                            "max": 100,
                            "palette": "green"
                          }
                        }
                      ]
                    },
                    "sortBy": []
                  },
                  "customWidth": "50",
                  "name": "TablePrivateBytesdns",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "//Process([\"dns\"])\\Working Set\r\nPerf \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"Process\" and CounterName == \"Working Set\" and InstanceName==\"dns\"\r\n| summarize Used_CPU = round(avg(CounterValue),1) by Computer, bin(TimeGenerated, ({TimeRange:end} - {TimeRange:start})/100)\r\n| render timechart\r\n",
                    "size": 0,
                    "aggregation": 3,
                    "showAnalytics": true,
                    "title": "Process([\"dns\"])\\Working Set",
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "visualization": "timechart",
                    "chartSettings": {
                      "ySettings": {
                        "numberFormatSettings": {
                          "unit": 2,
                          "options": {
                            "style": "decimal",
                            "useGrouping": true,
                            "maximumFractionDigits": 2
                          }
                        }
                      }
                    }
                  },
                  "customWidth": "50",
                  "name": "QueryWorkingSetdns",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "//Process([\"dns\"])\\Working Set\r\nlet trend = \r\nPerf \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"Process\" and CounterName == \"Working Set\" and InstanceName==\"dns\"\r\n| make-series Average = round(avg(CounterValue), 2) default = 0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step ({TimeRange:end} - {TimeRange:start})/100 by Computer     \r\n| project Computer, ['Trend'] = Average; \r\n\r\nPerf\r\n| where Computer in ({Computer})\r\n| where ObjectName == \"Process\" and CounterName == \"Working Set\" and InstanceName==\"dns\"\r\n| summarize Average=round(avg(CounterValue),2),StDev=round(stdevp(CounterValue),2), percentiles(CounterValue,50,75,95) by Computer\r\n| join (trend) on Computer\r\n//| extend Status = case (\r\n//                  Average > 1610612736, \"Critical\", //1.6GB\r\n//                  Average >= 1073741824, \"Warning\", //1GB\r\n//                  Average < 1073741824, \"Healthy\",\r\n//                  \"Unknown\")\r\n| project Computer, [\"Avg.\"]=Average,StDev,p50=round(percentile_CounterValue_50,2),p75=round(percentile_CounterValue_75,2),p95=round(percentile_CounterValue_95,2), Trend\r\n| sort by [\"Avg.\"]",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Working Set",
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Status",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "Healthy",
                                "representation": "success",
                                "text": "{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Warning",
                                "representation": "2",
                                "text": "{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Critical",
                                "representation": "critical",
                                "text": "{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "unknown",
                                "text": "{1}"
                              }
                            ],
                            "customColumnWidthSetting": "11ch"
                          }
                        },
                        {
                          "columnMatch": "Computer",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "28ch"
                          }
                        },
                        {
                          "columnMatch": "Avg.",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "blue",
                            "customColumnWidthSetting": "12ch"
                          },
                          "numberFormat": {
                            "unit": 2,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "StDev",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "orange",
                            "customColumnWidthSetting": "11ch"
                          },
                          "numberFormat": {
                            "unit": 2,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "p50",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "10ch"
                          },
                          "numberFormat": {
                            "unit": 2,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "p75",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "10ch"
                          },
                          "numberFormat": {
                            "unit": 2,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "p95",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "10ch"
                          },
                          "numberFormat": {
                            "unit": 2,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "Trend",
                          "formatter": 21,
                          "formatOptions": {
                            "min": 0,
                            "max": 100,
                            "palette": "green"
                          }
                        }
                      ]
                    },
                    "sortBy": []
                  },
                  "customWidth": "50",
                  "name": "TableWorkingSetdns",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "nav",
                    "links": [
                      {
                        "id": "3142de97-0271-4c36-9e7b-eb61a3f6eb79",
                        "cellValue": "TablePCTProcessorTimedns",
                        "linkTarget": "step",
                        "linkLabel": "Go back",
                        "style": "secondary"
                      }
                    ]
                  },
                  "customWidth": "90",
                  "name": "links - 18"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "selectedTab",
              "comparison": "isEqualTo",
              "value": "DNS"
            },
            "name": "DNSGroup"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "lsassGroup",
              "items": [
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "//Database([\"lsass\"])\\Database Cache % Hit\r\nPerf \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"Database\" and CounterName == \"Database Cache % Hit\" and InstanceName==\"lsass\"\r\n| summarize Used_CPU = round(avg(CounterValue),1) by Computer, bin(TimeGenerated, ({TimeRange:end} - {TimeRange:start})/100)\r\n| render timechart\r\n",
                    "size": 0,
                    "aggregation": 3,
                    "showAnalytics": true,
                    "title": "Database([\"lsass\"])\\Database Cache % Hit",
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "visualization": "timechart",
                    "chartSettings": {
                      "ySettings": {
                        "numberFormatSettings": {
                          "unit": 1,
                          "options": {
                            "style": "decimal",
                            "useGrouping": true,
                            "maximumFractionDigits": 2
                          }
                        }
                      }
                    }
                  },
                  "customWidth": "50",
                  "name": "QueryDatabaseCachePCTHit",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "//Database([\"lsass\"])\\Database Cache % Hit\r\nlet trend = \r\nPerf           \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"Database\" and CounterName == \"Database Cache % Hit\" and InstanceName==\"lsass\"\r\n| make-series Average = round(avg(CounterValue), 2) default = 0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step ({TimeRange:end} - {TimeRange:start})/100 by Computer     \r\n| project Computer, ['Trend'] = Average; \r\n\r\nPerf\r\n| where Computer in ({Computer})\r\n| where ObjectName == \"Database\" and CounterName == \"Database Cache % Hit\" and InstanceName==\"lsass\"\r\n| summarize Average=round(avg(CounterValue),2),StDev=round(stdevp(CounterValue),2), percentiles(CounterValue,50,75,95) by Computer\r\n| join (trend) on Computer\r\n| extend Status = case (\r\n                  Average > 75, \"Healthy\",\r\n                  Average >= 30, \"Warning\",\r\n                  Average < 30, \"Critical\",\r\n                  \"Unknown\")\r\n| project Status,Computer, [\"Avg.\"]=Average,StDev,p50=round(percentile_CounterValue_50,2),p75=round(percentile_CounterValue_75,2),p95=round(percentile_CounterValue_95,2), Trend\r\n| sort by [\"Avg.\"]",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Database Cache % Hit",
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Computer",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "28ch"
                          }
                        },
                        {
                          "columnMatch": "Avg.",
                          "formatter": 8,
                          "formatOptions": {
                            "min": -10,
                            "max": 100,
                            "palette": "blue",
                            "customColumnWidthSetting": "12ch"
                          },
                          "numberFormat": {
                            "unit": 1,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "StDev",
                          "formatter": 8,
                          "formatOptions": {
                            "min": -10,
                            "max": 100,
                            "palette": "orange",
                            "customColumnWidthSetting": "11ch"
                          },
                          "numberFormat": {
                            "unit": 1,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "p50",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          },
                          "numberFormat": {
                            "unit": 1,
                            "options": {
                              "style": "decimal"
                            }
                          }
                        },
                        {
                          "columnMatch": "p75",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          },
                          "numberFormat": {
                            "unit": 1,
                            "options": {
                              "style": "decimal"
                            }
                          }
                        },
                        {
                          "columnMatch": "p95",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          },
                          "numberFormat": {
                            "unit": 1,
                            "options": {
                              "style": "decimal"
                            }
                          }
                        },
                        {
                          "columnMatch": "Trend",
                          "formatter": 21,
                          "formatOptions": {
                            "min": 0,
                            "max": 100,
                            "palette": "green"
                          }
                        },
                        {
                          "columnMatch": "Status",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "Healthy",
                                "representation": "success",
                                "text": "{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Warning",
                                "representation": "2",
                                "text": "{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Critical",
                                "representation": "critical",
                                "text": "{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "unknown",
                                "text": "{1}"
                              }
                            ],
                            "customColumnWidthSetting": "11ch"
                          }
                        }
                      ]
                    },
                    "sortBy": []
                  },
                  "customWidth": "50",
                  "name": "TableDatabaseCachePCTHit",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "//Process([\"lsass\"])\\% Processor Time\r\nPerf \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"Process\" and CounterName == \"% Processor Time\" and InstanceName==\"lsass\"\r\n| summarize Used_CPU = round(avg(CounterValue),1) by Computer, bin(TimeGenerated, ({TimeRange:end} - {TimeRange:start})/100)\r\n| render timechart\r\n",
                    "size": 0,
                    "aggregation": 3,
                    "showAnalytics": true,
                    "title": "Process([\"lsass\"])\\% Processor Time",
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "visualization": "timechart",
                    "chartSettings": {
                      "ySettings": {
                        "numberFormatSettings": {
                          "unit": 1,
                          "options": {
                            "style": "decimal",
                            "useGrouping": true,
                            "maximumFractionDigits": 2
                          }
                        }
                      }
                    }
                  },
                  "customWidth": "50",
                  "name": "QueryPCTProcessorTimelsass",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "//Process([\"lsass\"])\\% Processor Time\r\nlet trend = \r\nPerf \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"Process\" and CounterName == \"% Processor Time\" and InstanceName==\"lsass\"\r\n| make-series Average = round(avg(CounterValue), 2) default = 0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step ({TimeRange:end} - {TimeRange:start})/100 by Computer     \r\n| project Computer, ['Trend'] = Average; \r\n\r\nPerf\r\n| where Computer in ({Computer})\r\n| where ObjectName == \"Process\" and CounterName == \"% Processor Time\" and InstanceName==\"lsass\"\r\n| summarize Average=round(avg(CounterValue),2),StDev=round(stdevp(CounterValue),2), percentiles(CounterValue,50,75,95) by Computer\r\n| join (trend) on Computer\r\n| extend Status = case (\r\n                  Average > 50, \"Critical\",\r\n                  Average >= 20, \"Warning\",\r\n                  Average < 20, \"Healthy\",\r\n                  \"Unknown\")\r\n| project Status,Computer, [\"Avg.\"]=Average,StDev,p50=round(percentile_CounterValue_50,2),p75=round(percentile_CounterValue_75,2),p95=round(percentile_CounterValue_95,2), Trend\r\n| sort by [\"Avg.\"]",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "% Processor Time",
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Status",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "Healthy",
                                "representation": "success",
                                "text": "{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Warning",
                                "representation": "2",
                                "text": "{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Critical",
                                "representation": "critical",
                                "text": "{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "unknown",
                                "text": "{1}"
                              }
                            ],
                            "customColumnWidthSetting": "11ch"
                          }
                        },
                        {
                          "columnMatch": "Computer",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "28ch"
                          }
                        },
                        {
                          "columnMatch": "Avg.",
                          "formatter": 8,
                          "formatOptions": {
                            "min": -10,
                            "max": 100,
                            "palette": "blue",
                            "customColumnWidthSetting": "12ch"
                          },
                          "numberFormat": {
                            "unit": 1,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "StDev",
                          "formatter": 8,
                          "formatOptions": {
                            "min": -10,
                            "max": 100,
                            "palette": "orange",
                            "customColumnWidthSetting": "11ch"
                          },
                          "numberFormat": {
                            "unit": 1,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "p50",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          },
                          "numberFormat": {
                            "unit": 1,
                            "options": {
                              "style": "decimal"
                            }
                          }
                        },
                        {
                          "columnMatch": "p75",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          },
                          "numberFormat": {
                            "unit": 1,
                            "options": {
                              "style": "decimal"
                            }
                          }
                        },
                        {
                          "columnMatch": "p95",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          },
                          "numberFormat": {
                            "unit": 1,
                            "options": {
                              "style": "decimal"
                            }
                          }
                        },
                        {
                          "columnMatch": "Trend",
                          "formatter": 21,
                          "formatOptions": {
                            "min": 0,
                            "max": 100,
                            "palette": "green"
                          }
                        }
                      ]
                    },
                    "sortBy": []
                  },
                  "customWidth": "50",
                  "name": "TablePCTProcessorTimelsass",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "//Process([\"lsass\"])\\Handle Count\r\nPerf \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"Process\" and CounterName == \"Handle Count\" and InstanceName==\"lsass\"\r\n| summarize Used_CPU = round(avg(CounterValue),1) by Computer, bin(TimeGenerated, ({TimeRange:end} - {TimeRange:start})/100)\r\n| render timechart\r\n",
                    "size": 0,
                    "aggregation": 3,
                    "showAnalytics": true,
                    "title": "Process([\"lsass\"])\\Handle Count",
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "visualization": "timechart",
                    "chartSettings": {
                      "ySettings": {
                        "numberFormatSettings": {
                          "unit": 17,
                          "options": {
                            "style": "decimal",
                            "useGrouping": true,
                            "maximumFractionDigits": 2
                          }
                        }
                      }
                    }
                  },
                  "customWidth": "50",
                  "name": "QueryHandleCountlsass",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "//Process([\"lsass\"])\\Handle Count\r\nlet trend = \r\nPerf \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"Process\" and CounterName == \"Handle Count\" and InstanceName==\"lsass\"\r\n| make-series Average = round(avg(CounterValue), 2) default = 0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step ({TimeRange:end} - {TimeRange:start})/100 by Computer     \r\n| project Computer, ['Trend'] = Average; \r\n\r\nPerf\r\n| where Computer in ({Computer})\r\n| where ObjectName == \"Process\" and CounterName == \"Handle Count\" and InstanceName==\"lsass\"\r\n| summarize Average=round(avg(CounterValue),2),StDev=round(stdevp(CounterValue),2), percentiles(CounterValue,50,75,95) by Computer\r\n| join (trend) on Computer\r\n| extend Status = case (\r\n                  Average > 30000, \"Critical\",\r\n                  Average >= 20000, \"Warning\",\r\n                  Average < 20000, \"Healthy\",\r\n                  \"Unknown\")\r\n| project Status,Computer, [\"Avg.\"]=Average,StDev,p50=round(percentile_CounterValue_50,2),p75=round(percentile_CounterValue_75,2),p95=round(percentile_CounterValue_95,2), Trend\r\n| sort by [\"Avg.\"]",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Handle Count",
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Status",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "Healthy",
                                "representation": "success",
                                "text": "{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Warning",
                                "representation": "2",
                                "text": "{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Critical",
                                "representation": "critical",
                                "text": "{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "unknown",
                                "text": "{1}"
                              }
                            ],
                            "customColumnWidthSetting": "11ch"
                          }
                        },
                        {
                          "columnMatch": "Computer",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "28ch"
                          }
                        },
                        {
                          "columnMatch": "Avg.",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "blue",
                            "customColumnWidthSetting": "12ch"
                          },
                          "numberFormat": {
                            "unit": 17,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "StDev",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "orange",
                            "customColumnWidthSetting": "11ch"
                          },
                          "numberFormat": {
                            "unit": 17,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "p50",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          },
                          "numberFormat": {
                            "unit": 17,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "p75",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          },
                          "numberFormat": {
                            "unit": 17,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "p95",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          },
                          "numberFormat": {
                            "unit": 17,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "Trend",
                          "formatter": 21,
                          "formatOptions": {
                            "min": 0,
                            "max": 100,
                            "palette": "green"
                          }
                        }
                      ]
                    },
                    "sortBy": []
                  },
                  "customWidth": "50",
                  "name": "TableHandleCountlsass - Copy",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "//Process([\"lsass\"])\\Private Bytes\r\nPerf \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"Process\" and CounterName == \"Private Bytes\" and InstanceName==\"lsass\"\r\n| summarize Used_CPU = round(avg(CounterValue),1) by Computer, bin(TimeGenerated, ({TimeRange:end} - {TimeRange:start})/100)\r\n| render timechart\r\n",
                    "size": 0,
                    "aggregation": 3,
                    "showAnalytics": true,
                    "title": "Process([\"lsass\"])\\Private Bytes",
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "visualization": "timechart",
                    "chartSettings": {
                      "ySettings": {
                        "numberFormatSettings": {
                          "unit": 2,
                          "options": {
                            "style": "decimal",
                            "useGrouping": true,
                            "maximumFractionDigits": 2
                          }
                        }
                      }
                    }
                  },
                  "customWidth": "50",
                  "name": "QueryPrivateByteslsass",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "//Process([\"lsass\"])\\Private Bytes\r\nlet trend = \r\nPerf \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"Process\" and CounterName == \"Private Bytes\" and InstanceName==\"lsass\"\r\n| make-series Average = round(avg(CounterValue), 2) default = 0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step ({TimeRange:end} - {TimeRange:start})/100 by Computer     \r\n| project Computer, ['Trend'] = Average; \r\n\r\nPerf\r\n| where Computer in ({Computer})\r\n| where ObjectName == \"Process\" and CounterName == \"Private Bytes\" and InstanceName==\"lsass\"\r\n| summarize Average=round(avg(CounterValue),2),StDev=round(stdevp(CounterValue),2), percentiles(CounterValue,50,75,95) by Computer\r\n| join (trend) on Computer\r\n| extend Status = case (\r\n                  Average > 1610612736, \"Critical\", //1.6GB\r\n                  Average >= 1073741824, \"Warning\", //1GB\r\n                  Average < 1073741824, \"Healthy\",\r\n                  \"Unknown\")\r\n| project Status,Computer, [\"Avg.\"]=Average,StDev,p50=round(percentile_CounterValue_50,2),p75=round(percentile_CounterValue_75,2),p95=round(percentile_CounterValue_95,2), Trend\r\n| sort by [\"Avg.\"]",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Private Bytes",
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Status",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "Healthy",
                                "representation": "success",
                                "text": "{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Warning",
                                "representation": "2",
                                "text": "{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Critical",
                                "representation": "critical",
                                "text": "{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "unknown",
                                "text": "{1}"
                              }
                            ],
                            "customColumnWidthSetting": "11ch"
                          }
                        },
                        {
                          "columnMatch": "Computer",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "28ch"
                          }
                        },
                        {
                          "columnMatch": "Avg.",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "blue",
                            "customColumnWidthSetting": "12ch"
                          },
                          "numberFormat": {
                            "unit": 2,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "StDev",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "orange",
                            "customColumnWidthSetting": "11ch"
                          },
                          "numberFormat": {
                            "unit": 2,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "p50",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "10ch"
                          },
                          "numberFormat": {
                            "unit": 2,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "p75",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "10ch"
                          },
                          "numberFormat": {
                            "unit": 2,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "p95",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "10ch"
                          },
                          "numberFormat": {
                            "unit": 2,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "Trend",
                          "formatter": 21,
                          "formatOptions": {
                            "min": 0,
                            "max": 100,
                            "palette": "green"
                          }
                        }
                      ]
                    },
                    "sortBy": []
                  },
                  "customWidth": "50",
                  "name": "TablePrivateByteslsass",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "//Process([\"lsass\"])\\Working Set\r\nPerf \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"Process\" and CounterName == \"Working Set\" and InstanceName==\"lsass\"\r\n| summarize Used_CPU = round(avg(CounterValue),1) by Computer, bin(TimeGenerated, ({TimeRange:end} - {TimeRange:start})/100)\r\n| render timechart\r\n",
                    "size": 0,
                    "aggregation": 3,
                    "showAnalytics": true,
                    "title": "Process([\"lsass\"])\\Working Set",
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "visualization": "timechart",
                    "chartSettings": {
                      "ySettings": {
                        "numberFormatSettings": {
                          "unit": 2,
                          "options": {
                            "style": "decimal",
                            "useGrouping": true,
                            "maximumFractionDigits": 2
                          }
                        }
                      }
                    }
                  },
                  "customWidth": "50",
                  "name": "QueryWorkingSetlsass",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "//Process([\"lsass\"])\\Working Set\r\nlet trend = \r\nPerf \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"Process\" and CounterName == \"Working Set\" and InstanceName==\"lsass\"\r\n| make-series Average = round(avg(CounterValue), 2) default = 0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step ({TimeRange:end} - {TimeRange:start})/100 by Computer     \r\n| project Computer, ['Trend'] = Average; \r\n\r\nPerf\r\n| where Computer in ({Computer})\r\n| where ObjectName == \"Process\" and CounterName == \"Working Set\" and InstanceName==\"lsass\"\r\n| summarize Average=round(avg(CounterValue),2),StDev=round(stdevp(CounterValue),2), percentiles(CounterValue,50,75,95) by Computer\r\n| join (trend) on Computer\r\n//| extend Status = case (\r\n//                  Average > 1610612736, \"Critical\", //1.6GB\r\n//                  Average >= 1073741824, \"Warning\", //1GB\r\n//                  Average < 1073741824, \"Healthy\",\r\n//                  \"Unknown\")\r\n| project Computer, [\"Avg.\"]=Average,StDev,p50=round(percentile_CounterValue_50,2),p75=round(percentile_CounterValue_75,2),p95=round(percentile_CounterValue_95,2), Trend\r\n| sort by [\"Avg.\"]",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Working Set",
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Status",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "Healthy",
                                "representation": "success",
                                "text": "{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Warning",
                                "representation": "2",
                                "text": "{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Critical",
                                "representation": "critical",
                                "text": "{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "unknown",
                                "text": "{1}"
                              }
                            ],
                            "customColumnWidthSetting": "11ch"
                          }
                        },
                        {
                          "columnMatch": "Computer",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "28ch"
                          }
                        },
                        {
                          "columnMatch": "Avg.",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "blue",
                            "customColumnWidthSetting": "12ch"
                          },
                          "numberFormat": {
                            "unit": 2,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "StDev",
                          "formatter": 8,
                          "formatOptions": {
                            "palette": "orange",
                            "customColumnWidthSetting": "11ch"
                          },
                          "numberFormat": {
                            "unit": 2,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "p50",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "10ch"
                          },
                          "numberFormat": {
                            "unit": 2,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "p75",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "10ch"
                          },
                          "numberFormat": {
                            "unit": 2,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "p95",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "10ch"
                          },
                          "numberFormat": {
                            "unit": 2,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "Trend",
                          "formatter": 21,
                          "formatOptions": {
                            "min": 0,
                            "max": 100,
                            "palette": "green"
                          }
                        }
                      ]
                    },
                    "sortBy": []
                  },
                  "customWidth": "50",
                  "name": "TableWorkingSetlsass",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "nav",
                    "links": [
                      {
                        "id": "3142de97-0271-4c36-9e7b-eb61a3f6eb79",
                        "cellValue": "TableDatabaseCachePCTHit",
                        "linkTarget": "step",
                        "linkLabel": "Go back",
                        "style": "secondary"
                      }
                    ]
                  },
                  "customWidth": "90",
                  "name": "links - 18"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "selectedTab",
              "comparison": "isEqualTo",
              "value": "lsass"
            },
            "name": "lsassGroup"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "DirectoryServicesGroup",
              "items": [
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "//DirectoryServices([\"NTDS\"])\\DRA Pending Replication Operations\r\nPerf \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"DirectoryServices\" and CounterName == \"DRA Pending Replication Operations\" and InstanceName==\"NTDS\"\r\n| summarize Used_CPU = round(avg(CounterValue),1) by Computer, bin(TimeGenerated, ({TimeRange:end} - {TimeRange:start})/100)\r\n| render timechart\r\n",
                    "size": 0,
                    "aggregation": 3,
                    "showAnalytics": true,
                    "title": "DirectoryServices([\"NTDS\"])\\DRA Pending Replication Operations",
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "visualization": "timechart",
                    "chartSettings": {
                      "ySettings": {
                        "numberFormatSettings": {
                          "unit": 17,
                          "options": {
                            "style": "decimal",
                            "useGrouping": true,
                            "maximumFractionDigits": 2
                          }
                        }
                      }
                    }
                  },
                  "customWidth": "50",
                  "name": "QueryDRAPendingReplicationOperationsNTDS",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "//DirectoryServices([\"NTDS\"])\\DRA Pending Replication Operations\r\nlet trend = \r\nPerf           \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"DirectoryServices\" and CounterName == \"DRA Pending Replication Operations\" and InstanceName==\"NTDS\"\r\n| make-series Average = round(avg(CounterValue), 2) default = 0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step ({TimeRange:end} - {TimeRange:start})/100 by Computer     \r\n| project Computer, ['Trend'] = Average; \r\n\r\nPerf\r\n| where Computer in ({Computer})\r\n| where ObjectName == \"DirectoryServices\" and CounterName == \"DRA Pending Replication Operations\" and InstanceName==\"NTDS\"\r\n| summarize Average=round(avg(CounterValue),2),StDev=round(stdevp(CounterValue),2), percentiles(CounterValue,50,75,95) by Computer\r\n| join (trend) on Computer\r\n| extend Status = case (\r\n                  Average > 5, \"Critical\",\r\n                  Average >= 3, \"Warning\",\r\n                  Average < 3, \"Healthy\",\r\n                  \"Unknown\")\r\n| project Status,Computer, [\"Avg.\"]=Average,StDev,p50=round(percentile_CounterValue_50,2),p75=round(percentile_CounterValue_75,2),p95=round(percentile_CounterValue_95,2), Trend\r\n| sort by [\"Avg.\"]",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "DRA Pending Replication Operations",
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Status",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "Healthy",
                                "representation": "success",
                                "text": "{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Warning",
                                "representation": "2",
                                "text": "{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Critical",
                                "representation": "critical",
                                "text": "{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "unknown",
                                "text": "{1}"
                              }
                            ],
                            "customColumnWidthSetting": "11ch"
                          }
                        },
                        {
                          "columnMatch": "Computer",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "28ch"
                          }
                        },
                        {
                          "columnMatch": "Avg.",
                          "formatter": 8,
                          "formatOptions": {
                            "min": -10,
                            "max": 100,
                            "palette": "blue",
                            "customColumnWidthSetting": "12ch"
                          },
                          "numberFormat": {
                            "unit": 0,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "StDev",
                          "formatter": 8,
                          "formatOptions": {
                            "min": -10,
                            "max": 100,
                            "palette": "orange",
                            "customColumnWidthSetting": "11ch"
                          },
                          "numberFormat": {
                            "unit": 0,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "p50",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          }
                        },
                        {
                          "columnMatch": "p75",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          }
                        },
                        {
                          "columnMatch": "p95",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          }
                        },
                        {
                          "columnMatch": "Trend",
                          "formatter": 21,
                          "formatOptions": {
                            "min": 0,
                            "max": 100,
                            "palette": "green"
                          }
                        }
                      ]
                    },
                    "sortBy": []
                  },
                  "customWidth": "50",
                  "name": "TableDRAPendingReplicationOperationsNTDS",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "//DirectoryServices([\"NTDS\"])\\DRA Pending Replication Synchronizations\r\nPerf \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"DirectoryServices\" and CounterName == \"DRA Pending Replication Synchronizations\" and InstanceName==\"NTDS\"\r\n| summarize Used_CPU = round(avg(CounterValue),1) by Computer, bin(TimeGenerated, ({TimeRange:end} - {TimeRange:start})/100)\r\n| render timechart\r\n",
                    "size": 0,
                    "aggregation": 3,
                    "showAnalytics": true,
                    "title": "DirectoryServices([\"NTDS\"])\\DRA Pending Replication Synchronizations",
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "visualization": "timechart",
                    "chartSettings": {
                      "ySettings": {
                        "numberFormatSettings": {
                          "unit": 17,
                          "options": {
                            "style": "decimal",
                            "useGrouping": true,
                            "maximumFractionDigits": 2
                          }
                        }
                      }
                    }
                  },
                  "customWidth": "50",
                  "name": "QueryDRAPendingReplicationSynchronizationsNTDS - Copy",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "//DirectoryServices([\"NTDS\"])\\DRA Pending Replication Synchronizations\r\nlet trend = \r\nPerf           \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"DirectoryServices\" and CounterName == \"DRA Pending Replication Synchronizations\" and InstanceName==\"NTDS\"\r\n| make-series Average = round(avg(CounterValue), 2) default = 0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step ({TimeRange:end} - {TimeRange:start})/100 by Computer     \r\n| project Computer, ['Trend'] = Average; \r\n\r\nPerf\r\n| where Computer in ({Computer})\r\n| where ObjectName == \"DirectoryServices\" and CounterName == \"DRA Pending Replication Synchronizations\" and InstanceName==\"NTDS\"\r\n| summarize Average=round(avg(CounterValue),2),StDev=round(stdevp(CounterValue),2), percentiles(CounterValue,50,75,95) by Computer\r\n| join (trend) on Computer\r\n| extend Status = case (\r\n                  Average > 5, \"Critical\",\r\n                  Average >= 3, \"Warning\",\r\n                  Average < 3, \"Healthy\",\r\n                  \"Unknown\")\r\n| project Status,Computer, [\"Avg.\"]=Average,StDev,p50=round(percentile_CounterValue_50,2),p75=round(percentile_CounterValue_75,2),p95=round(percentile_CounterValue_95,2), Trend\r\n| sort by [\"Avg.\"]",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "DRA Pending Replication Synchronizations",
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Status",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "Healthy",
                                "representation": "success",
                                "text": "{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Warning",
                                "representation": "2",
                                "text": "{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Critical",
                                "representation": "critical",
                                "text": "{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "unknown",
                                "text": "{1}"
                              }
                            ],
                            "customColumnWidthSetting": "11ch"
                          }
                        },
                        {
                          "columnMatch": "Computer",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "28ch"
                          }
                        },
                        {
                          "columnMatch": "Avg.",
                          "formatter": 8,
                          "formatOptions": {
                            "min": -10,
                            "max": 100,
                            "palette": "blue",
                            "customColumnWidthSetting": "12ch"
                          },
                          "numberFormat": {
                            "unit": 0,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "StDev",
                          "formatter": 8,
                          "formatOptions": {
                            "min": -10,
                            "max": 100,
                            "palette": "orange",
                            "customColumnWidthSetting": "11ch"
                          },
                          "numberFormat": {
                            "unit": 0,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "p50",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          }
                        },
                        {
                          "columnMatch": "p75",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          }
                        },
                        {
                          "columnMatch": "p95",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          }
                        },
                        {
                          "columnMatch": "Trend",
                          "formatter": 21,
                          "formatOptions": {
                            "min": 0,
                            "max": 100,
                            "palette": "green"
                          }
                        }
                      ]
                    },
                    "sortBy": []
                  },
                  "customWidth": "50",
                  "name": "TableDRAPendingReplicationSynchronizationsNTDS - Copy",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "//DirectoryServices([\"NTDS\"])\\LDAP Client Sessions\r\nPerf \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"DirectoryServices\" and CounterName == \"LDAP Client Sessions\" and InstanceName == \"NTDS\"\r\n| summarize Used_CPU = round(avg(CounterValue),1) by Computer, bin(TimeGenerated, ({TimeRange:end} - {TimeRange:start})/100)\r\n| render timechart\r\n",
                    "size": 0,
                    "aggregation": 3,
                    "showAnalytics": true,
                    "title": "DirectoryServices([\"NTDS\"])\\LDAP Client Sessions",
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "visualization": "timechart",
                    "chartSettings": {
                      "ySettings": {
                        "numberFormatSettings": {
                          "unit": 17,
                          "options": {
                            "style": "decimal",
                            "useGrouping": true,
                            "maximumFractionDigits": 2
                          }
                        }
                      }
                    }
                  },
                  "customWidth": "50",
                  "name": "QueryLDAPClientSessions",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "//DirectoryServices([\"NTDS\"])\\LDAP Client Sessions\r\nlet trend = \r\nPerf \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"DirectoryServices\" and CounterName == \"LDAP Client Sessions\" and InstanceName == \"NTDS\"\r\n| make-series Average = round(avg(CounterValue), 2) default = 0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step ({TimeRange:end} - {TimeRange:start})/100 by Computer     \r\n| project Computer, ['Trend'] = Average; \r\n\r\nPerf\r\n| where Computer in ({Computer})\r\n| where ObjectName == \"DirectoryServices\" and CounterName == \"LDAP Client Sessions\" and InstanceName == \"NTDS\"\r\n| summarize Average=round(avg(CounterValue),2),StDev=round(stdevp(CounterValue),2), percentiles(CounterValue,50,75,95) by Computer\r\n| join (trend) on Computer\r\n| project Computer, [\"Avg.\"]=Average,StDev,p50=round(percentile_CounterValue_50,2),p75=round(percentile_CounterValue_75,2),p95=round(percentile_CounterValue_95,2), Trend\r\n| sort by [\"Avg.\"]",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "LDAP Client Sessions",
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Status",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "Healthy",
                                "representation": "success",
                                "text": "{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Warning",
                                "representation": "2",
                                "text": "{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Critical",
                                "representation": "critical",
                                "text": "{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "unknown",
                                "text": "{1}"
                              }
                            ],
                            "customColumnWidthSetting": "11ch"
                          }
                        },
                        {
                          "columnMatch": "Computer",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "28ch"
                          }
                        },
                        {
                          "columnMatch": "Avg.",
                          "formatter": 8,
                          "formatOptions": {
                            "min": -10,
                            "max": 100,
                            "palette": "blue",
                            "customColumnWidthSetting": "12ch"
                          },
                          "numberFormat": {
                            "unit": 0,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "StDev",
                          "formatter": 8,
                          "formatOptions": {
                            "min": -10,
                            "max": 100,
                            "palette": "orange",
                            "customColumnWidthSetting": "11ch"
                          },
                          "numberFormat": {
                            "unit": 0,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "p50",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          }
                        },
                        {
                          "columnMatch": "p75",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          }
                        },
                        {
                          "columnMatch": "p95",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          }
                        },
                        {
                          "columnMatch": "Trend",
                          "formatter": 21,
                          "formatOptions": {
                            "min": 0,
                            "max": 100,
                            "palette": "green"
                          }
                        }
                      ]
                    },
                    "sortBy": []
                  },
                  "customWidth": "50",
                  "name": "TableLDAPClientSessionsNTDS",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "nav",
                    "links": [
                      {
                        "id": "3142de97-0271-4c36-9e7b-eb61a3f6eb79",
                        "cellValue": "TableDRAPendingReplicationOperationsNTDS",
                        "linkTarget": "step",
                        "linkLabel": "Go back",
                        "style": "secondary"
                      }
                    ]
                  },
                  "customWidth": "90",
                  "name": "links - 18"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "selectedTab",
              "comparison": "isEqualTo",
              "value": "DirectoryServices"
            },
            "name": "DirectoryServicesGroup"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "AuthenticationsGroup",
              "items": [
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "//Security System-Wide Statistics([\"\"])\\Kerberos Authentications\r\nPerf \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"Security System-Wide Statistics\" and CounterName == \"Kerberos Authentications\" \r\n| summarize Used_CPU = round(avg(CounterValue),1) by Computer, bin(TimeGenerated, ({TimeRange:end} - {TimeRange:start})/100)\r\n| render timechart\r\n",
                    "size": 0,
                    "aggregation": 3,
                    "showAnalytics": true,
                    "title": "Security System-Wide Statistics\\Kerberos Authentications",
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "visualization": "timechart",
                    "chartSettings": {
                      "ySettings": {
                        "numberFormatSettings": {
                          "unit": 17,
                          "options": {
                            "style": "decimal",
                            "useGrouping": true,
                            "maximumFractionDigits": 2
                          }
                        }
                      }
                    }
                  },
                  "customWidth": "50",
                  "name": "QueryKerberosAuthentications",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "//Security System-Wide Statistics([\"\"])\\Kerberos Authentications\r\nlet trend = \r\nPerf           \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"Security System-Wide Statistics\" and CounterName == \"Kerberos Authentications\" \r\n| make-series Average = round(avg(CounterValue), 2) default = 0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step ({TimeRange:end} - {TimeRange:start})/100 by Computer     \r\n| project Computer, ['Trend'] = Average; \r\n\r\nPerf\r\n| where Computer in ({Computer})\r\n| where ObjectName == \"Security System-Wide Statistics\" and CounterName == \"Kerberos Authentications\" \r\n| summarize Average=round(avg(CounterValue),2),StDev=round(stdevp(CounterValue),2), percentiles(CounterValue,50,75,95) by Computer\r\n| join (trend) on Computer\r\n| project Computer, [\"Avg.\"]=Average,StDev,p50=round(percentile_CounterValue_50,2),p75=round(percentile_CounterValue_75,2),p95=round(percentile_CounterValue_95,2), Trend\r\n| sort by [\"Avg.\"]",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "Kerberos Authentications",
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Status",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "Healthy",
                                "representation": "success",
                                "text": "{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Warning",
                                "representation": "2",
                                "text": "{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Critical",
                                "representation": "critical",
                                "text": "{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "unknown",
                                "text": "{1}"
                              }
                            ],
                            "customColumnWidthSetting": "11ch"
                          }
                        },
                        {
                          "columnMatch": "Computer",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "28ch"
                          }
                        },
                        {
                          "columnMatch": "Avg.",
                          "formatter": 8,
                          "formatOptions": {
                            "min": -10,
                            "max": 100,
                            "palette": "blue",
                            "customColumnWidthSetting": "12ch"
                          },
                          "numberFormat": {
                            "unit": 0,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "StDev",
                          "formatter": 8,
                          "formatOptions": {
                            "min": -10,
                            "max": 100,
                            "palette": "orange",
                            "customColumnWidthSetting": "11ch"
                          },
                          "numberFormat": {
                            "unit": 0,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "p50",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          }
                        },
                        {
                          "columnMatch": "p75",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          }
                        },
                        {
                          "columnMatch": "p95",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          }
                        },
                        {
                          "columnMatch": "Trend",
                          "formatter": 21,
                          "formatOptions": {
                            "min": 0,
                            "max": 100,
                            "palette": "green"
                          }
                        }
                      ]
                    },
                    "sortBy": []
                  },
                  "customWidth": "50",
                  "name": "TableKerberosAuthentications",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "//Security System-Wide Statistics([\"\"])\\NTLM Authentications\r\nPerf \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"Security System-Wide Statistics\" and CounterName == \"NTLM Authentications\" \r\n| summarize Used_CPU = round(avg(CounterValue),1) by Computer, bin(TimeGenerated, ({TimeRange:end} - {TimeRange:start})/100)\r\n| render timechart\r\n",
                    "size": 0,
                    "aggregation": 3,
                    "showAnalytics": true,
                    "title": "Security System-Wide Statistics\\NTLM Authentications",
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "visualization": "timechart",
                    "chartSettings": {
                      "ySettings": {
                        "numberFormatSettings": {
                          "unit": 17,
                          "options": {
                            "style": "decimal",
                            "useGrouping": true,
                            "maximumFractionDigits": 2
                          }
                        }
                      }
                    }
                  },
                  "customWidth": "50",
                  "name": "QueryNTLMAuthentications",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let trend = \r\nPerf           \r\n| where Computer in ({Computer})\r\n| where ObjectName == \"Security System-Wide Statistics\" and CounterName == \"NTLM Authentications\" \r\n| make-series Average = round(avg(CounterValue), 2) default = 0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step ({TimeRange:end} - {TimeRange:start})/100 by Computer     \r\n| project Computer, ['Trend'] = Average; \r\n\r\nPerf\r\n| where Computer in ({Computer})\r\n| where ObjectName == \"Security System-Wide Statistics\" and CounterName == \"NTLM Authentications\" \r\n| summarize Average=round(avg(CounterValue),2),StDev=round(stdevp(CounterValue),2), percentiles(CounterValue,50,75,95) by Computer\r\n| join (trend) on Computer\r\n| project Computer, [\"Avg.\"]=Average,StDev,p50=round(percentile_CounterValue_50,2),p75=round(percentile_CounterValue_75,2),p95=round(percentile_CounterValue_95,2), Trend\r\n| sort by [\"Avg.\"]",
                    "size": 0,
                    "showAnalytics": true,
                    "title": "NTLM Authentications",
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Status",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "Healthy",
                                "representation": "success",
                                "text": "{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Warning",
                                "representation": "2",
                                "text": "{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Critical",
                                "representation": "critical",
                                "text": "{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "unknown",
                                "text": "{1}"
                              }
                            ],
                            "customColumnWidthSetting": "11ch"
                          }
                        },
                        {
                          "columnMatch": "Computer",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "28ch"
                          }
                        },
                        {
                          "columnMatch": "Avg.",
                          "formatter": 8,
                          "formatOptions": {
                            "min": -10,
                            "max": 100,
                            "palette": "blue",
                            "customColumnWidthSetting": "12ch"
                          },
                          "numberFormat": {
                            "unit": 0,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "StDev",
                          "formatter": 8,
                          "formatOptions": {
                            "min": -10,
                            "max": 100,
                            "palette": "orange",
                            "customColumnWidthSetting": "11ch"
                          },
                          "numberFormat": {
                            "unit": 0,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "p50",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          }
                        },
                        {
                          "columnMatch": "p75",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          }
                        },
                        {
                          "columnMatch": "p95",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "9ch"
                          }
                        },
                        {
                          "columnMatch": "Trend",
                          "formatter": 21,
                          "formatOptions": {
                            "min": 0,
                            "max": 100,
                            "palette": "green"
                          }
                        }
                      ]
                    },
                    "sortBy": []
                  },
                  "customWidth": "50",
                  "name": "TableNTLMAuthentications",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "selectedTab",
              "comparison": "isEqualTo",
              "value": "Authentications"
            },
            "name": "AuthenticationsGroup"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "selectedTab",
        "comparison": "isEqualTo",
        "value": "ActiveDirectory"
      },
      "name": "ActiveDirectoryGroup",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "DetailedGroup",
        "items": [
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "parameters": [
                {
                  "id": "7fd398c9-6e13-4319-a8b8-3289dc423d9e",
                  "version": "KqlParameterItem/1.0",
                  "name": "Computer",
                  "type": 2,
                  "description": "Maximum number of selected computers: 10",
                  "isRequired": true,
                  "multiSelect": true,
                  "quote": "'",
                  "delimiter": ",",
                  "query": "Heartbeat\r\n| where Computer in (MyDCs)\r\n| distinct Computer\r\n| order by Computer asc",
                  "crossComponentResources": [
                    "{Workspace}"
                  ],
                  "typeSettings": {
                    "limitSelectTo": 10,
                    "additionalResourceOptions": [],
                    "showDefault": false
                  },
                  "timeContext": {
                    "durationMs": 0
                  },
                  "timeContextFromParameter": "TimeRange",
                  "queryType": 0,
                  "resourceType": "microsoft.operationalinsights/workspaces",
                  "value": [
                    "AST-Demo-DC02.contoso.com",
                    "VAST-Demo-DC01.contoso.com"
                  ]
                },
                {
                  "id": "d495f8c1-c6b2-490e-8eb6-43d151bc20c0",
                  "version": "KqlParameterItem/1.0",
                  "name": "PerformanceCounter",
                  "type": 2,
                  "description": "Select a virtual machine performance counter to display in the chart below",
                  "isRequired": true,
                  "query": "Perf\r\n| where TimeGenerated {TimeRange}\r\n| summarize by CounterName, ObjectName, InstanceName,CounterText = iif(isnotempty(InstanceName),strcat(CounterName,' (',InstanceName,')'),CounterName)\r\n| order by ObjectName asc, CounterText asc,InstanceName asc\r\n| project Counter = pack('counter', CounterName, 'object', ObjectName, 'instance', InstanceName), CounterText, group = ObjectName",
                  "crossComponentResources": [
                    "{Workspace}"
                  ],
                  "typeSettings": {
                    "additionalResourceOptions": [],
                    "showDefault": false
                  },
                  "queryType": 0,
                  "resourceType": "microsoft.operationalinsights/workspaces",
                  "value": "{\"counter\":\"NTLM Authentications\",\"object\":\"Security System-Wide Statistics\",\"instance\":\"\"}"
                },
                {
                  "id": "31b68fb4-3740-406d-b8eb-ac29cb461c3f",
                  "version": "KqlParameterItem/1.0",
                  "name": "CounterText",
                  "type": 1,
                  "query": "let metric = dynamic({PerformanceCounter});\r\nrange Steps from 1 to 1 step 1\r\n| project strcat(metric.object, \" > \", metric.counter)",
                  "crossComponentResources": [
                    "{Workspace}"
                  ],
                  "isHiddenWhenLocked": true,
                  "queryType": 0,
                  "resourceType": "microsoft.operationalinsights/workspaces"
                },
                {
                  "id": "4bf4bd96-531d-4d30-b1ba-1aef067fbc6e",
                  "version": "KqlParameterItem/1.0",
                  "name": "Granularity",
                  "type": 2,
                  "isRequired": true,
                  "typeSettings": {
                    "additionalResourceOptions": [],
                    "showDefault": false
                  },
                  "jsonData": "[\r\n    { \"value\":\"1m\", \"label\":\"1m\", \"selected\":false },\r\n    { \"value\":\"5m\", \"label\":\"5m\", \"selected\":false},\r\n    { \"value\":\"15m\", \"label\":\"15m\", \"selected\":false},\r\n    { \"value\":\"30m\", \"label\":\"30m\", \"selected\":true},\r\n    { \"value\":\"1h\", \"label\":\"1h\", \"selected\":false},\r\n    { \"value\":\"6h\", \"label\":\"6h\", \"selected\":false},\r\n    { \"value\":\"24h\", \"label\":\"24h\", \"selected\":false}  \r\n]"
                },
                {
                  "id": "dff91367-8a90-4d46-8a43-8595972eacc8",
                  "version": "KqlParameterItem/1.0",
                  "name": "Aggregates",
                  "type": 2,
                  "description": "Select one or more aggregates for the performance counter to display in the chart below",
                  "isRequired": true,
                  "multiSelect": true,
                  "quote": "",
                  "delimiter": ",",
                  "isHiddenWhenLocked": true,
                  "typeSettings": {
                    "additionalResourceOptions": [],
                    "showDefault": false
                  },
                  "jsonData": "[\r\n    { \"value\":\"Average = round(avg(CounterValue), 2)\", \"label\":\"Average\", \"selected\":true },\r\n    { \"value\":\"P1st = round(percentile(CounterValue, 1), 2)\", \"label\":\"P1st\", \"selected\":false},\r\n    { \"value\":\"P5th = round(percentile(CounterValue, 5), 2)\", \"label\":\"P5th\", \"selected\":false},\r\n    { \"value\":\"P10th = round(percentile(CounterValue, 10), 2)\", \"label\":\"P10th\", \"selected\":false},\r\n    { \"value\":\"P50th = round(percentile(CounterValue, 50), 2)\", \"label\":\"P50th\", \"selected\":false},\r\n    { \"value\":\"P90th = round(percentile(CounterValue, 90), 2)\", \"label\":\"P90th\", \"selected\":false},\r\n    { \"value\":\"P95th = round(percentile(CounterValue, 95), 2)\", \"label\":\"P95th\", \"selected\":false},\r\n    { \"value\":\"P99th = round(percentile(CounterValue, 99), 2)\", \"label\":\"P99th\", \"selected\":false},\r\n    { \"value\":\"Min = round(min(CounterValue), 2)\", \"label\":\"Min\", \"selected\":false},\r\n    { \"value\":\"Max = round(max(CounterValue), 2)\", \"label\":\"Max\", \"selected\":false}    \r\n]",
                  "value": [
                    "Average = round(avg(CounterValue), 2)"
                  ]
                }
              ],
              "style": "pills",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "name": "parameters - 3"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let metric = dynamic({PerformanceCounter});\r\nPerf\r\n| where TimeGenerated {TimeRange}\r\n| where Computer in ({Computer})\r\n| where ObjectName == metric.object and CounterName == metric.counter and InstanceName == metric.instance\r\n| summarize {Aggregates} by bin(TimeGenerated, {Granularity}),strcat(Computer,' (',InstanceName,')')",
              "size": 0,
              "aggregation": 3,
              "showAnalytics": true,
              "title": "Detailed view by computer and performance counter: {CounterText}",
              "timeContextFromParameter": "TimeRange",
              "timeBrushParameterName": "trBrush",
              "timeBrushExportOnlyWhenBrushed": true,
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "timechart",
              "chartSettings": {
                "showLegend": true
              }
            },
            "name": "query - 0"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let metric = dynamic({PerformanceCounter});\r\nPerf\r\n| where TimeGenerated {trBrush}\r\n| where Computer in ({Computer})\r\n| where ObjectName == metric.object and CounterName == metric.counter and InstanceName == metric.instance\r\n| summarize {Aggregates} by bin(TimeGenerated, ({trBrush:end} - {trBrush:start})/100),strcat(Computer,' (',InstanceName,')')",
              "size": 0,
              "aggregation": 3,
              "showAnalytics": true,
              "title": "Detailed view by computer and performance counter. Time brushed to {trBrush}",
              "timeContextFromParameter": "TimeRange",
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "timechart",
              "chartSettings": {
                "showLegend": true
              }
            },
            "name": "query - 0 - Copy"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "selectedTab",
        "comparison": "isEqualTo",
        "value": "Detailed"
      },
      "name": "DetailedGroup",
      "styleSettings": {
        "showBorder": true
      }
    }
  ],
  "fallbackResourceIds": [
    "azure monitor"
  ],
  "$schema": "https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json"
}